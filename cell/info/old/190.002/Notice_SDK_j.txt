[SCE CONFIDENTIAL DOCUMENT]
PLAYSTATION(R)3 Programmer Tool Runtime Library 190.002
                    Copyright(C) 2007 Sony Computer Entertainment Inc.
                                                   All Rights Reserved.
======================================================================
以下にReference Tool SDKパッケージに関する既知の不具合・制限事項・注意事項を
記述します。

新規に更新した箇所にリリースバージョンを追加しましたので参照してください。

----------------------------------------------------------------------
Reference Tool
----------------------------------------------------------------------
- RSX(R)から音声出力を行うプログラムを動作させるときに、以下のいずれかの
  操作行うと、音声出力されないという不具合があります。
  - HDMIケーブルの抜き差しを行う
  - TVモニタ（AV Amp含む）の電源のOff→On
  - TVモニタ（AV Amp含む）のチャネルを切り替えて、再度HDMI入力に設定する

- 以下のデバイスは現在サポートされておりません。

  - CompactFlash(R)
  - SDメモリーカード
  - FOOT SW

  無線機能(Bluetooth(R)/Wireless LAN)は Reference Toolの認証取得の関係から
  DEH-R1040 以降の Reference Tool 以外で使用する事が出来ません。
  アンテナは DEH-1040 以降のReference Tool に同梱されておりますので、
  DEH-R1030 以前の Reference Tool には接続しないでください。

- Reference Tool の各スペックに関しては、
  info/Reference_System-Supplement_*.pdfを参照してください。

----------------------------------------------------------------------
CBE仕様
----------------------------------------------------------------------
- 現在、各機種とも、搭載CBEはSPU 6個が使用可能となっています。

----------------------------------------------------------------------
システムソフトウェア(GUI) 
----------------------------------------------------------------------
- デバッガ起動時の電源オフ処理時にプロセス終了待ちが行われるように
  なった為、ゲームアプリケーションの終了処理に対応していない幾つかの
  サンプルにおいて、デバッガ起動時に電源オフ処理を行うとタイムアウトが
  発生し、警告音とともにシステムが強制終了してしまう不具合があります。 

----------------------------------------------------------------------
システムユーティリティ
----------------------------------------------------------------------
< Web Browserユーティリティ >
- ダウンローダを使用したファイルのダウンロードができません。

< On-Screen Keyboard ユーティリティ>
- オプション辞書機能は未対応です。

< コンテンツ検索ユーティリティ >
(Release 190.002 追加)
- cellSearchPrepareFile()でコンテンツの静止画サムネイル及び
  動画サムネイルのファイルパスを作成した後、そのコンテンツの
  サムネイルをシステムソフトウェア等から変更した場合、再度
  cellSearchPrepareFile()を実行しないとその変更が反映されません。

< セーブデータユーティリティ >
(Release 190.002 追加)
- cellSaveDataListDelete() でリスト表示されたデータのサムネイル横に
  表示される文字列に関して、dirNamePrefix に指定した値が、

      "*" の場合、"タイトル" が表示される
      それ以外の場合、"サブタイトル" が表示される

  となるのが正しい挙動ですが、SDK190時点では全て、"タイトル" となっています。
  今後の SDK にて修正予定です。

(Release 190.002 追加)
- cellSaveDataListDelete() で一度データを削除すると、
  画面下に表示される "決定" のボタンナビゲーションが消えたままになります。
  今後の SDK にて修正予定です。

(Release 190.002 追加)
- cellSaveDataListImport() で一度データをコピーすると、
  画面下に表示される "決定" のボタンナビゲーションが消えたままになります。
  今後の SDK にて修正予定です。

< ビデオユーティリティ >
(Release 190.002 追加)
- ビデオユーティリティでエクスポート後、エクスポートしたファイルが
  置かれていたディレクトリが空になった場合に、そのディレクトリが削除
  されます。

< オーディオ設定ユーティリティ >
(Release 190.002 追加)
- cellAudioInGetAvailableDeviceInfo() は、
  "PlayStation 2" 専用 "EyeToy" USB カメラ/PLAYSTATION(R)Eye などの
  デバイスに対応していません。今後のリリースで対応します。

(Release 190.002 追加)
- マルチマイクモードではUSBデバイスの型を引数に指定して
  cellAudioInRegisterDevice()を呼び出し、デバイスをシステムソフトウェアへ
  登録します。
  その後、登録された型に合致したデバイスがシステムソフトウェアに認識された
  場合は自動的にそのデバイスを有効化し、デバイス番号を割り当てます。
  よって、ゲームアプリケーションが使用する型のデバイスが PS3 に複数接続されて
  いる場合は、それら全てが自動的に認識され、有効化されてしまいます。
  現時点では一部のデバイスのみを有効化する事は出来ませんので今後のバージョン
  アップで何らかの仕組みを検討致します。

----------------------------------------------------------------------
BDエミュレータ(HDD)
----------------------------------------------------------------------
- Windows 上で BD エミュレータをご利用になる際、dtcfsutil.exeを使う際、
  msys 上では動作いたしません。
  コマンドプロンプト上で dtcfsutil.exe を使用してください。
  なお、Linux 上では問題ありません。
  また、BDエミュレータ用HDD のフォーマットを行なう際にも上記の制限が
  あります。

----------------------------------------------------------------------
ファイルシステム
----------------------------------------------------------------------
<cellftp>
- put コマンドのオプション -u は、指定しても正しく動作いたしません。 

- copy コマンド、及び copydir コマンドのオプション -u を
  指定してもコピー先が HOSTFS の場合には正しく動作いたしません。

----------------------------------------------------------------------
libftp
----------------------------------------------------------------------
- 2個以上のストリームを同時に転送すると、転送速度が大幅に遅くなります。

- Internet Explorer 6.0 を使用した場合に接続に失敗する場合があります。

- Passive transfer mode (PASV)は、現在サポートしていません。

- Rename commands (RNFR/RNTO)は、現在サポートしていません。

----------------------------------------------------------------------
Cell OS Lv-2
----------------------------------------------------------------------
- sys_memory_container_create() にて上限数以上のメモリコンテナを 
  作ろうとすると、新しいメモリコンテナに対して、既に割り当て済の 
  メモリコンテナと同じ ID が返される不具合が発生します。この時、 
  古い方のメモリコンテナは sys_memory_container_destroy() にて 
  破棄することができず、ゲームプロセス終了時にもシステムによって 
  回収されない可能性があります。 

  [回避策] 
  ゲームプロセスにて生成するメモリコンテナの数は、必ず、 
  同時には10個以内になるようにしてください。 

(Release 190.002 追加)
- 以下の制限事項があります。

  - SDK190より、SYS_PROCESS_PARAM によってスタックサイズが 4 KB に設定された
    PPU プログラムは、 main 関数が呼ばれる前に DSI が発生するため、プログラム
    を実行することができません。

    SDK190以降、スタックサイズは 8 KB 以上を指定するようにして下さい。

(Release 190.002 追加)
- 軽量条件変数 ( lwcond ) に関連付けた軽量ミューテックス ( lwmutex ) の
  性能が低下してしまう不具合があります。

  詳細
  sys_lwcond_signal() を呼んだ時に sys_lwcond_wait() している PPU スレッドが
  存在しない時に発生し、以降の sys_lwmutex_lock()/unlock() の性能が落ちます。
  性能低下は lwmutex で待っているスレッドが存在しないシーケンスにおいて
  観測でき、具体的には

  sys_lwmutex_lock() で 約 0.17 usec -> 約 1.9 usec
  sys_lwmutex_unlock() で 約 0.18 usec -> 約 1.0 usec

  ほど性能が低下します。

  回避方法は、

  -  waiter が 1 スレッドの場合
     sys_lwcond_signal_all() を使う

  -  waiter が 複数スレッドの場合
     1) wait 中のスレッドが存在する場合のみ sys_lwcond_signal() を実行する
     2) sys_lwcond_signal_to() を使う

  となります。

----------------------------------------------------------------------
libfont
----------------------------------------------------------------------
- 縦書き用関数は、中国語用配置が未サポートとなっています。
  また、内部の縦書き用文字置き換えで、全角(){} が、縦書き用文字コードに
  置き換わりません。
  直接縦書き用文字コードを指定するか、半角(){} を使用してください。

----------------------------------------------------------------------
C/C++標準ライブラリ 
----------------------------------------------------------------------
- PPU側のプログラムをコンパイルする際に、以下のコンパイルオプションを
  指定すると大量にwarningが出力される場合があります。

  -Wall -Wundef -Wundef -Wsystem-headers -Wcast-qual

- math.h をインクルードした SPU プログラムをコンパイルする際において、
  コンパイルオプションとして -fsingle-precision-constant を指定すると
  エラーが発生します.

- システムヘッダをインクルードする際には extern "C" または extern "C++"
  の外側で行ってください.

  例えば以下のようなプログラムをコンパイルするとエラーとなる場合があります.

    extern "C" {
      ...

      #include <yyyy> // NG : extern "C" の内側でインクルードしている

      ...
    }

  上記のようなプログラムは以下のように書き換えることによりエラーを回避できます.

    #include <yyyy>
    extern "C" {

      ... 

    }

(Release 190.002 追加)
<PPU>
- <iostream>をインクルードしたプログラムのスタートアップ時には、iostreamの
  コンストラクタがnew演算子を呼び出します。main関数実行前のnewの呼び出しを
  避けたい場合は、iostreamを利用しないようにしてください。

<PPU>
- atexit関数の使用方法に、以下の制限があります。

  * atexit関数でPRXモジュール内の関数を登録し、PRXモジュールの終了処理を
    行った後で、main関数を終了、もしくはexit 関数を呼び出すと、DSI(data 
    storage interrupt)が発生します。

  * C++のグローバルコンストラクタでatexit関数を使用した場合、C++の
    言語仕様と異なり、登録された全ての関数は、全てのグローバル
    デストラクタに先だって実行されます。

<PPU>
- PRX中で、クラスios_baseまたはその派生クラス(fstream, iostream,
  stringstream, strstreamなど)を使用する場合には、オブジェクトの生成は
  ELF側で行い、それへのポインタをPRX側に渡すようにしてください。PRX側で
  生成を行った場合には、PPUプログラムの終了時に_Fac_tidy()関数でDSI(data 
  storage interrupt)が発生する可能性があります。

<SPU>
- スタックまたはヒープ領域を大量に使うことにより、ヒープ領域を破壊してし
  まう場合があります。SPU ABIでは、スタックポインタから正のオフセットの
  メモリに加えて、-2000までの負のオフセットのメモリの使用を許可していま
  すが、不具合により、負のオフセットの使用が保証できないことがあります。
  スタックポインタからの負のオフセットは、spu_printf()、リーフ関数などで
  使用されています。

----------------------------------------------------------------------
Vector Math
----------------------------------------------------------------------
- Vector Mathライブラリの平方根や平方根の逆数を計算する関数は、
  精度よりも速度を重視しているため、IEEE 基準のfloat型の演算精度を
  満たしておりません。

----------------------------------------------------------------------
libcamera
----------------------------------------------------------------------
- 他のUSBデバイスの抜き差しが行われると、切り替え時にいくつかの
  ビデオフレームが失われる場合があります。

- USB Video Class (UVC)カメラの制限事項
  1. USB 2.0 対応であっても UVC 対応でないカメラはサポートしません。
  2. ストリーミング機能のないカメラはサポートしません。
  3. USB 1.1 ハブ経由で接続したカメラはサポートしません。
  4. ミラー機能はサポートしません。
  5. カメラは 1 台のみサポートします。
  6. "PlayStation 2" 専用 "EyeToy" USB カメラが接続されている場合、
     "PlayStation 2" 専用 "EyeToy" USB カメラが優先されます。

----------------------------------------------------------------------
libmic
----------------------------------------------------------------------
- システムのエコーキャンセラーは、USBスピーカーをサポートしていません。
  USB スピーカーに出力する場合にオーディオチャットがエコーフィードバック、
  またはハウリングを引き起こす可能性があります。

----------------------------------------------------------------------
libusbd
----------------------------------------------------------------------
- 本体USBポートにおけるデバイスの抜き差しにより、本体USBポートに
  接続されている他のUSBデバイスのデータ通信が乱れたり、切断されてしまう
  ことがあります。
  回避方法としては、自己電源(セルフパワー)HUBを本体USBポートに
  接続するようにしてください。

----------------------------------------------------------------------
MultiStream
----------------------------------------------------------------------
- タイムドメインモードにおいて、24khzより低いサンプリング周波数のADPCM
  データはノイズが発生してしまう不具合があります。

(Release 190.002 追加)
- cellMSSystemConfigureSysUtil()でシステムユーティリティの情報を用いて
  音声出力の設定を行う場合、正しく設定されないという不具合があります。
  cellAudioOutGetSoundAvailability()で利用可能なオーディオモードを調べてから
  cellAudioOutConfigure()で音声出力の変更を行ってください。

----------------------------------------------------------------------
libperf
----------------------------------------------------------------------
- SDK180より前のlibperf.aをリンクしたプログラムで、Lv-2の
  システムコールトレースをバックトレースつきで有効化した場合、
  SDK180以降にシステムアップデートされたターゲットシステム上では
  動作しません。(libperf/ppuサンプルが該当)
  SDK180以降にリリースされているlibperf.aを使用してください。

----------------------------------------------------------------------
SPU Runtime Library
----------------------------------------------------------------------
<libspurs タスク>
(Release 190.002 追加)
- SPURSタスクが同期オブジェクトを呼び出した際に以下の条件を満たすと
  動作が不定になる不具合があります。

  - 待ち状態になる条件を満たしている
  - コンテキスト保存領域は設定されているがLSパターンに
    stack領域が含まれていない

  このとき、CELL_SPURS_TASK_ERROR_STATが返りますが、呼び出した
  同期オブジェクトの状態が壊れ、この同期オブジェクトに対する
  以後の呼び出しは動作不定になります。
  また、呼び出したSPURSタスクはエラーを受けた後、待ち状態になる
  インタフェースを呼ぶと動作不定になります。

<libspurs ジョブ>
(Release 190.002 追加)
- cellSpursRunJobChain()を実行した際、一時的にReady Countの値より
  多いSPUがジョブを実行してしまうことがある不具合があります。

----------------------------------------------------------------------
libgcm
----------------------------------------------------------------------
(Release 190.002 追加)
- cellGcmSetTile()を使用してRSX(R)に対して領域の重なったタイル設定が
  行われた場合、RSX(R)のアドレス変換機能が正しく動作しません。

  このためタイル領域が重なっているかどうかチェックする機能を追加した
  新規関数 cellGcmSetTileInfo()、cellGcmBindTile()を追加しました。

  今後の開発にはcellGcmSetTile()およびcellGcmSetInvalidateTile()の代わりに
  cellGcmSetTileInfo()、cellGcmBindTile()、cellGcmUnbindTile()を
  使用してください。
  cellGcmSetTile()、 cellGcmSetInvalidateTile()は、今後のリリースにおいて
  削除され使用できなくなる予定です。

(Release 190.002 追加)
- cellGcmSetZcull()の第10引数sFuncにおいて、CELL_GCM_ALWAYS、CELL_GCM_LESS
  などの定数が使用できていましたが、これは正しい呼び出し方ではありません。
  これらを新規関数cellGcmBindZcull()で使用するとエラーとなりますので、
  CELL_GCM_SCULL_SFUNC_ALWAYS、CELL_GCM_SCULL_SFUNC_LESSを使用してください。

----------------------------------------------------------------------
libgcm_tool
----------------------------------------------------------------------
- libgcm_toolのWindows用ライブラリは、VisualStudio2005でのみ使用可能です。
  また、サンプルのプロジェクトファイルはVisualStudio2005で作成しました。
  ライブラリおよびサンプルともVisualStudio2003には対応しておりません。

----------------------------------------------------------------------
libsail
----------------------------------------------------------------------
- ユーザ定義ソースの機能については現在、β版扱いとなります。
  ユーザ定義ソースの機能を使ってマスターアップをする場合は必ず、
  正式版の機能を含んだlibsailに切り替えて下さい。

(Release 190.002 追加)
- MP4ファイルについては、録画ユーティリティで作成され、かつ内蔵HDD上に
  存在するもののみ再生を保障します。それ以外のMP4ファイルを再生する
  コードをアプリケーションに組み込まないでください。

----------------------------------------------------------------------
NP Commerce
----------------------------------------------------------------------
- sceNpCommerceGetProductCategoryStart() の第 3 引数 lang_code に
  CELL_SYSUTIL_LANG_CHINESE_T を指定しても正しく動作しません。

----------------------------------------------------------------------
NP Matching
----------------------------------------------------------------------
(Release 190.002 追加)
- NPマッチングのAPIで成功時の返り値が0より大きいことがあります。
  本現象が発生するAPIは次の2つです。
    - sceNpMatchingGetResult()
    - sceNpMatchingGetRoomMemberListLocal()

  上記APIの引数 buf に NULL 以外を設定して実行した場合に発生します。
