[SCE CONFIDENTIAL DOCUMENT]
PlayStation(R)3 Programmer Tool Toolchain 300.001
                    Copyright(C) 2009 Sony Computer Entertainment Inc.
                                                  All Rights Reserved.
======================================================================
The following are the new features and fixed bugs of PlayStation(R)3 
Programmer Tool Toolchain package. 

- Additions of new features and changes in Release 300.001
- Bugs fixed in Release 300.001

======================================================================
New Additions and Changes in Release 300.001
----------------------------------------------------------------------
SN Systems Linker
----------------------------------------------------------------------
[Additions]
(B#55818)
- Add support for dead stripping PRX output.

(B#59076)
- Added --temp-dir=<path> switch for user control of the directory 
  used for temporary files.

[Specification Changes]
(B#70662)
- Apply --pad-debug-line=1 by default when dead stripping is enabled.

(B#70661)
- Removed the deprecated --external-make-fself switch.

(B#69318)
- Change the behaviour of the linker when no arguments are passed 
  to print out usage text rather than help text.

[Bugfixes]
(B#72788)
- Prevent de-duplication from reducing alignment.
  This could lead to program failure or corrupted data at runtime 
  depending on the situation.

(B#70464)
- Fix failure to patch TOC-switching shim relocations, 
  which resulted in a broken ELF file.
  The problem was indicated by warning L0152 originating from a 
  (linker-synthesised) shim file (e.g., "warning: L0152: R_PPC64_REL24 patch
  value 0x0202a7f8 out of range (file /Shim0/)").

(B#71373)
- Fixed a common crash when attempting to dead strip relocatable code.

(B#70658)
- The --compress-output switch is now compatible with the --ppuguid switch.

(B#71256)
- Made the warnings for incorrect command-line switches more consistent.

(B#67154)
- Implement --oformat=prx and --oformat=fsprx on Linux hosts.

(B#67407)
- Implement --warn-built-before for Linux hosts.

(B#55813)
- --Map, --exceptions, --strip-unused and --strip-unused-data linker
arguments are now propagated to the link phase when generating PRXs.

(B#70524)
- Produce an error message when a user tries to create a package 
  from an existing package.

----------------------------------------------------------------------
GCC
----------------------------------------------------------------------
[Additions]
<PPU/SPU>
(B#67084)
- Support __builtin_snpause() as a builtin function of PPU/SPU GCC.

(B#50251)
- #pragma comment(lib, "libname") has been newly supported.

(B#71823)
- Option -femit-class-debug-always has been added.
  Debugging information on the class is generated by all object files 
  that use the class.
  The default of -femit-class-debug-always is off.

<SPU>
(B#58403)
- SPU toolchain sets some bits in e_flags field in an ELF file header 
  to record which SPU runtime model is used to build the program.
  The 3 least significant bits in e_flags are used to encode 
  the SPU runtime model.
  The encoding is defined as follows:

    0b000: built without -mspurs-* option
    0b001: built with -mspurs-job
    0b010: built with -mspurs-job-initialize
    0b011: built with -mspurs-task
    0b100-0b111 are reserved for future use.

[Specification Changes]
<PPU/SPU>
(B#67441)
- ppu-lv2-readelf and spu-lv2-readelf have been changed.
  Previously, if numerical values usually displayed in decimal 
  exceeded 99999, they were displayed in hexadecimal.
  They are now displayed in decimal.
  When a new option --hexadecimal is specified, 
  numerical values are always displayed in hexadecimal 
  and are prefixed by "0x".

<PPU>
(B#44758)
- The assembler has been changed so that it outputs an error message 
  when some operands are missing.

(B#65294)
- When "-mprx" or "-mprx-with-runtime" was specified for ppu-lv2-g++
  to link a PRX, redundant "-stdc++" and "-lm" were passed implicitly.
  This problem has been fixed.
  For linking a PRX, "-lstdc++_stub" and "-lm_stub" should be used.

<SPU>
(B#69267)
- If -shread is specified, dll_crt.o will be linked.
  By this change, each DLL will have its own queue for atexit.

[Bugfixes]
<PPU/SPU>
(B#70308)
- In the case of the following program, the assembler might generate an error.
  This problem has been fixed.

    --- bug.s ---
           .byte 0, 0
           .uleb128 (ETY-X)
    X:     .space 16381
           .align 2
    ETY:
           .long 4 
    -------------
    bug.s: Assembler messages:
    bug.s:7: Fatal error: Infinite loop encountered whilst attempting to compute the addresses of symbols in section .text

(B#69490)
- tree-nrv optimization generated a wrong code.
  This problem has been fixed.

(B#72475)
- The following internal compiler error could happen 
  if a template actual argument accompanied __attribute__.

    internal compiler error: Segmentation fault

  This problem has been fixed.

<PPU>
(B#64584)
- If the game application is created with both the -mno-toc option and 
  an optimization option of -O2 or higher, certain function calls can cause 
  problems due to tail call optimization, including infinite loops and the 
  usage of incorrect TOC register values.
  The problem has been fixed.

  Please refer to "Limitation (1)" of the technote 200907-14 for more details:

    https://ps3.scedev.net/technotes/view/941

(B#75996)
- If a program is compiled using precompiled headers and 
  if it uses vector keyword, the following error occurred.
  The problem has been fixed.

    C language:
      error: 'vector' undeclared (first use in this function)

    C++ language:
      error: 'vector' was not declared in this scope

(B#75686)
- The bug that is described in the following technote has been fixed.

  - Problem with libgcm Caused by Enabling -mno-toc (GCC Option) for 
    Application Build

    (Technical Notes ID:200907-13  https://ps3.scedev.net/technotes/view/940)

<SPU>
(B#72238)
- In some cases the linker would crash when linking with -fPIC or 
  -fpic.
  This has been fixed.
