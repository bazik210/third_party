[SCE CONFIDENTIAL DOCUMENT]
PLAYSTATION(R)3 Programmer Tool Runtime Library 250.001
                    Copyright(C) 2008 Sony Computer Entertainment Inc.
                                                   All Rights Reserved.
======================================================================
以下にReference Tool SDKパッケージに関する既知の不具合・制限事項・注意事項を
記述します。

新規に更新した箇所にリリースバージョンを追加しましたので参照してください。

----------------------------------------------------------------------
Reference Tool
----------------------------------------------------------------------
- Reference Tool の各スペックに関しては、
  SDK_doc\jp(en)\pdf\development_basic\Reference_System-Supplement_*.pdfを
  参照してください。

----------------------------------------------------------------------
CBE仕様
----------------------------------------------------------------------
- 現在、各機種とも、搭載CBEはSPU 6個が使用可能となっています。

----------------------------------------------------------------------
システムソフトウェア
----------------------------------------------------------------------
<ゲーム列のCheckメニュー>
- ゲーム列のCheckメニューで行なうチェックでは、メディアの検証、
  ファイルシステム自体を検証することはできません。

  マスターディスクを納品する際には、Disc Image Generator for PLAYSTATION(R)3
  またはDisc Image Checker for PLAYSTATION(R)3を用いてマスターディスクの検証を
  行い、エラーが無いことを必ず確認してください。

- ゲーム列のCheckメニューで行なうチェックにおいて、USBマスストレージに
  保存されるチェック結果ファイルの数が80～100個程度を超えると、
  USBマスストレージのルートディレクトリのファイルエントリを使い切って
  しまうために それ以降保存ができなくなることがあります。
  この場合にはいったんチェック結果ファイルを別ディレクトリなどに
  移動させてください。

----------------------------------------------------------------------
システムユーティリティ
----------------------------------------------------------------------
<On-Screen Keyboard ユーティリティ>
- オプション辞書機能は未対応です。

(Release 250.001 追加)
- cellOskDialogExtRegisterKeyboardEventHookCallback()で登録された関数の
  呼び出し直後にcellOskDialogExtSendFinishMessage()を用いてゲーム
  アプリケーションから強制的に文字列を確定、もしくはキャンセルした場合に
  フリーズする場合がある。

(Release 250.001 追加)
- 日本語入力の変換状態で、変換状態が複数文節に分かれている時に次の文字
  入力を始めると未確定状態の文字列のうち、先頭の文節以外の文節が消えて
  確定される。

<リモートプレイユーティリティ>
- PSP(R)システムソフトウェアのバージョン3.72以降が必要になります。

<ゲームアップデートユーティリティ>
-  管理ツールなどで設定する起動パラメータに"デバッガモード"を選択して
   起動させた Reference Tool では、ゲームアップデートユーティリティ
   のパッチ配信機能を使用することはできません。

<オーディオ設定ユーティリティ>
- マルチマイクモードでは、まず、ゲームアプリケーションが利用を希望する音声
  入力デバイスの型を引数deviceTypeに指定してcellAudioInRegisterDevice()を
  実行し、音声入力デバイスをシステムへ登録します。
  cellAudioInRegisterDevice()を呼び出すと与えられた型にマッチする音声入力
  デバイス の有る無しにかかわらず、システムソフトウェアによって自動的にデ
  バイス番号が、その音声入力デバイスに割り当てられます（そのデバイス番号の
  音声入力デバイスが利用可能になった事はlibmicの cellMicIsAttached() を使
  ってポーリングを行って調べるか、libmicのイベントによる通知で知ることがで
  きます）。

  上記の通り、デバイス番号が自動的に割り当てられる為、ゲームアプリケーション
  が使用する型のUSBデバイス(音声入力デバイス)がPLAYSTATION(R)3に複数接続され
  ている場合は、どのUSBポートのデバイスが、どのデバイス番号に割り当てられて
  いるかを一意に判別する事が出来ません。
  この場合は画面にメーター(ボリューム)等を表示するなどして、ユーザインター
  フェース側で判断出来るようにして下さい。
  なお、今後のリリースにおいて特定のデバイスに明示的にデバイス番号を割り当て
  るような仕組みを提供する予定です。

<コンテンツ検索ユーティリティ>
- cellSearchPrepareFile()でコンテンツの静止画サムネイル及び
  動画サムネイルのファイルパスを作成した後、そのコンテンツの
  サムネイルをシステムソフトウェア等から変更した場合、再度
  cellSearchPrepareFile()を実行しないとその変更が反映されません。

<バックグラウンドダウンロードユーティリティ>
- ゲームアプリケーション起動中にもバックグラウンドダウンロードは続行
  しますが、以下の条件においてダウンロードが停止します。

    - ゲームアプリケーションがソケットを 1つ以上作成しているとき
    - NP シグナリングユーティリティを使用したコネクションが 1つ以上
      存在するとき
    - AV チャットユーティリティ、AV チャット 2ユーティリティを
      使用しているとき

  上記条件から外れるとバックグラウンドダウンロードが再開されますが
  バックグラウンドダウンロードの進行状況に依存したゲームアプリケー
  ションの作りにはしないで下さい。

  また、新規ユーティリティの追加による条件の追加、及び変更などが
  ある場合は、本技術情報にて告知させていただきます。
 （技術情報ID:200803-15  https://ps3.scedev.net/technotes/view/708）

<スクリーンショットユーティリティ>
(Release 250.001 追加)
- PNGのチャンクに設定された値は、システムソフトウェアから外部メディア
 （Memory Stick(TM) など）にコピーしたときにも保存されていますが、
  その保存したものをシステムソフトウェアに取り込んだ場合には、
  値はシステムソフトウェアの情報画面に反映されません。
  これは現時点での制約事項であり、将来のシステムソフトウェアで対応する
  予定です。

<ミュージックデコードユーティリティ>
(Release 250.001 追加)
- ミュージックデコードユーティリティには以下の不具合があります。
  - デコード中に、CELL_MUSIC_DECODE_CMD_NEXT もしくは 
    CELL_MUSIC_DECODE_CMD_PREV コマンドを発行すると、次 もしくは 
    前の曲に正常に移行しないことがある。

  - 特定の曲を使用した場合に、LPCMデータを取得できない。
 （技術情報ID:200810-13  https://ps3.scedev.net/technotes/view/817）

<フォトユーティリティ>
(Release 250.001 追加)
- cellPhotoDecodeInitialize() のデコード用メモリコンテナを指定する
  引数 container2 に2MB以下のメモリコンテナを指定して関数を呼び出すと、
  デコードに必要なメモリコンテナのサイズが2MB以下で十分な場合でも、
  無条件に CELL_PHOTO_DECODE_ERROR_PARAM を返してデコード機能の初期化に
  失敗する不具合があります。
 （技術情報ID:200810-17  https://ps3.scedev.net/technotes/view/821）

----------------------------------------------------------------------
GTF
----------------------------------------------------------------------
(Release 250.001 追加)
- dds2gtf を使用するに当たって以下の制限があります。
  - UYVY, YUY2 形式は、GTFに対応するフォーマットが無いため、
    それぞれ R8B8_R8G8, B8R8_G8R8 形式として変換されます。

----------------------------------------------------------------------
libmixer
----------------------------------------------------------------------
- cellSurMixerSurBusAddData()の引数 samples に指定するサンプル数は
  4の倍数である必要があります。

----------------------------------------------------------------------
libsail
----------------------------------------------------------------------
- PAMFファイル再生の場合ストリームの終端の数フレーム(1～3枚程度)は
  取得できません。

- MP4ファイルについては、内蔵HDD上に存在するもののみ再生を保障します。
  それ以外のMP4ファイルを再生する コードをアプリケーションに組み込まない
  でください。

(Release 250.001 追加)
- libsailを用いたムービー再生において、特定のトリックプレイを行った際に
  正しく動作しません
 （技術情報ID:200810-02  https://ps3.scedev.net/technotes/view/806）

----------------------------------------------------------------------
libperf
----------------------------------------------------------------------
- SDK180より前のlibperf.aをリンクしたプログラムで、Lv-2の
  システムコールトレースをバックトレースつきで有効化した場合、
  SDK180以降にシステムアップデートされたターゲットシステム上では
  動作しません。(libperf\ppuサンプルが該当)
  SDK180以降にリリースされているlibperf.aを使用してください。

- (B#43808)
  ターゲット上の計測モジュールを使用するため、libperfのサンプルプログラム
  をTuner for PLAYSTATION(R)3で計測することはできません。

----------------------------------------------------------------------
libfs
----------------------------------------------------------------------
(Release 250.001 更新)
- SDK220におけるシステムソフトウェアの使用メモリ量削減の一環として、
  ファイルシステムがデフォルトで使用するメモリ量が削減されました。
  この影響で、細かい単位 (16KB以下)でデータの読み書きを行う場合に、
  SDK21xに比較して、若干性能劣化がある場合があります。また、複数スレッド
  から同時にファイルアクセスするケースではリクエストの処理時間が若干かかる
  場合があります。
  新規追加されましたcellFsSetIoBuffer()などのAPIを使ってアプリケーションから
  メモリを追加することで性能を向上することができることもありますが、
  逆に性能が落ちることもありますので実際に性能を確認してご利用ください。

- SDK220 より、CFS(SYS_DEV_HDD0)で同時オープンファイル
  数が上限を超えた場合、エラーを返すようになりました。
  SDK21x以前からSDK220に更新された場合、これまで返っていなかったエラーが
  返るようになる可能性がありますので、ご注意ください。

- (B#47766)
  /dev_hdd0に対してcellFsTruncate()またはcellFsFtruncate()の呼び出しで
  ファイルサイズを0にした場合、その後のファイル操作が永久にブロックされて
  しまう不具合があります。
 （技術情報ID:200804-07 https://ps3.scedev.net/technotes/view/716）

----------------------------------------------------------------------
Cell OS Lv-2
----------------------------------------------------------------------
- SYS_PROCESS_PARAM によってスタックサイズが 4 KB に設定された
  PPU プログラムは、 main 関数が呼ばれる前に DSI が発生するため、
  プログラムを実行することができません。

  [回避策]
  プライマリ PPU スレッドのスタックサイズは、8 KB 以上を指定するようにして
  下さい。

(Release 250.001 追加)
- (B#58555)
  プロセスの終了の呼び出しと割り込みスレッドからのオブジェクトを生成する
  何らかのシステムコールの呼び出しが重なった場合、そのシステムコールが 
  EABORT を返します。

  [回避策]
  ありません。

----------------------------------------------------------------------
libcamera
----------------------------------------------------------------------
- USB Video Class (UVC)カメラの制限事項
  1. USB 2.0 対応であっても UVC 対応でないカメラはサポートしません。
  2. ストリーミング機能のないカメラはサポートしません。
  3. USB 1.1 ハブ経由で接続したカメラはサポートしません。
  4. ミラー機能はサポートしません。
  5. カメラは 1 台のみサポートします。

----------------------------------------------------------------------
libpad for Windows
----------------------------------------------------------------------
- Windows XP にのみ対応しています。
  Windows Vista には、将来対応する予定です。

----------------------------------------------------------------------
libfont
----------------------------------------------------------------------
(Release 250.001 追加)
- レンダリング関数を、マルチスレッドで同時に呼び出すと動作不定となる不具合が
  あります。
  レンダリング関数をマルチスレッドで呼び出す場合には、Cell OS Lv-2の同期プ
  リミティブシステムコールを使用する等、排他処理を実装して回避してください。

(Release 250.001 追加)
- cellFontOpenFontFile()を使用したオープンおよびクローズを伴い、複数の外部
  フォントの読み替えを行なった場合に、ライブラリ内部でメモリリーク
  が発生し、ハングアップ等を引き起こす場合があります。
  今後のリリースにおいて修正する予定です。

  不具合が修正されるまで、外部フォントの読み替えを行なう場合は、
  以下のどちらかの手順で代用してください。

  - ライブラリの終了/初期化の工程も含め、オープン処理をやり直す
  - cellFontOpenFontMemory()を使用する

- 縦書き用関数は、中国語用配置が未サポートとなっています。
  また、内部の縦書き用文字置き換えで、全角(){} が、縦書き用文字コードに
  置き換わりません。
  直接縦書き用文字コードを指定するか、半角(){} を使用してください。

- 縦書き用関数は、プロポーショナルな縦書きレイアウトに未対応となっています。

----------------------------------------------------------------------
libftp
----------------------------------------------------------------------
- 2個以上のストリームを同時に転送すると、転送速度が大幅に遅くなります。

- Internet Explorer 6.0 を使用した場合に接続に失敗する場合があります。

- Passive transfer mode (PASV)は、現在サポートしていません。

----------------------------------------------------------------------
cgc
----------------------------------------------------------------------
(Release 250.001 追加)
- (B#52202)
  sce-cgc 1.6 は、いくつの一時レジスタが必要か決定しようとするときに
  制限を超えてしまい、特定のバーテックスシェーダーのコンパイルに失敗する
  ことがあります。
  典型的なエラーメッセージ:
  (0) : error C6001: Temporary register limit of 32 exceeded; 34 
  registers needed to compile program

  修正する予定はありませんので、このエラーに該当する場合は
  sce-cgc 2.0 への移行をご検討下さい。

----------------------------------------------------------------------
libgcm
----------------------------------------------------------------------
- cellGcmSetZcull()を使ってZcull領域のアンバインドを設定することはできません。
  Zcull領域のアンバインド設定にはcellGcmUnbindZcull()を使用してください。

- cellGcmSetTile()を使用してRSX(R)に対して領域の重なったタイル設定が
  行われた場合、RSX(R)のアドレス変換機能が正しく動作しません。

  このためタイル領域が重なっているかどうかチェックする機能を追加した
  新規関数 cellGcmSetTileInfo()、cellGcmBindTile()を追加しました。

  今後の開発にはcellGcmSetTile()およびcellGcmSetInvalidateTile()の代わりに
  cellGcmSetTileInfo()、cellGcmBindTile()、cellGcmUnbindTile()を
  使用してください。
  cellGcmSetTile()、 cellGcmSetInvalidateTile()は、今後のリリースにおいて
  削除され使用できなくなる予定です。

(Release 250.001 追加)
- cellGcmSetSurface(), cellGcmSetSurfaceWindow() のデバッグ版を使用した際に
  各関数内部にて不正なアサート処理が行なわれる事があります。
 （技術情報ID:200807-25  https://ps3.scedev.net/technotes/view/777）

(Release 250.001 追加)
- gcmのサンプルにおいて cellGcmSetViewport() の設定方法に誤りがありました。
  ただし、サンプルの動作自体に問題はありません。
 （技術情報ID:200808-06  https://ps3.scedev.net/technotes/view/785）

----------------------------------------------------------------------
C/C++標準ライブラリ 
----------------------------------------------------------------------
<SPU>
- (B#20077) 
  C++でnew_handlerを設定していない場合、newでメモリを割り当てに失敗すると
  無限ループになります。

- PPU側のプログラムをコンパイルする際に、以下のコンパイルオプションを
  指定すると大量にwarningが出力される場合があります。

  -Wall -Wundef -Wundef -Wsystem-headers -Wcast-qual

- システムヘッダをインクルードする際には extern "C" または extern "C++"
  の外側で行ってください。

  例えば以下のようなプログラムをコンパイルするとエラーとなる場合があります。

    extern "C" {
      ...

      #include <yyyy> // NG : extern "C" の内側でインクルードしている

      ...
    }

  上記のようなプログラムは以下のように書き換えることによりエラーを回避できます。

    #include <yyyy>
    extern "C" {

      ... 

    }

<PPU>
- <iostream>をインクルードしたプログラムのスタートアップ時には、iostreamの
  コンストラクタがnew演算子を呼び出します。main関数実行前のnewの呼び出しを
  避けたい場合は、iostreamを利用しないようにしてください。

<PPU>
- atexit関数の使用方法に、以下の制限があります。

  * C++のグローバルコンストラクタでatexit関数を使用した場合、C++の
    言語仕様と異なり、登録された全ての関数は、全てのグローバル
    デストラクタに先だって実行されます。
    この順序を部分的に変更することもできます。詳細は「Cell OS Lv-2 ツール
    チェーン ユーザガイド」を参照してください。

<PPU>
- PRX中で、クラスios_baseまたはその派生クラス(fstream, iostream,
  stringstream, strstreamなど)を使用する場合には、オブジェクトの生成は
  ELF側で行い、それへのポインタをPRX側に渡すようにしてください。PRX側で
  生成を行った場合には、PPUプログラムの終了時に_Fac_tidy()関数でDSI(data 
  storage interrupt)が発生する可能性があります。

(Release 250.001 追加)
<PPU>
- (B#49602)
  SDK220から、math.hのSIMD数値演算関数である、cbrtf4とcbrtf4fastに
  不具合があり、SDK210以前と同じ結果を返しません。

  例:
  vec_float4 vf = (vec_float4){1.73e-2f, 3.0f, 27.0f, FLT_MAX};
  printf("%vf\n", cbrtf4(vf));

  SDK210以前の結果: 0.258632  1.442249  3.000000  6981462523904.000409
  SDK220以降の結果: 0.258681  1.372409 -5.020100  nan

  この不具合は、将来のSDKで修正予定です。

----------------------------------------------------------------------
カスタムテーマ
----------------------------------------------------------------------
- 効果音データが長すぎる場合、特定の場面で音声が途中で途切れることが
  あります。
  詳細は、「カスタムテーマ仕様書」を参照ください。

----------------------------------------------------------------------
libmic
----------------------------------------------------------------------
(Release 250.001 追加)
- "PlayStation 2" 専用 "EyeToy" USB カメラと PLAYSTATION(R)Eye がカメラ
  モードの場合のみ、CELLMIC_DEVATTR_LED は LED ライトを制御します。

----------------------------------------------------------------------
libfios
----------------------------------------------------------------------
(Release 250.001 追加)
- Edge Zlib もしくは Edge LZMA を使うには、PLAYSTATION(R)Edge 0.4.2
  をダウンロードし、インストールしてください。

(Release 250.001 追加)
- アーカイブファイルを作成する際に、アーカイブ対象ファイルと出力ファイルの
  名前が同じで、さらに -y もしくは --overwrite オプションが指定された
  場合、アーカイブ対象ファイルが上書きされ復元できなくなります。

(Release 250.001 追加)
- overlay を使ってリダイレクトしているディレクトリに対して
  scheduler::readDirectory() を行うと、リダイレクトが反映されずに
  元のディレクトリのディレクトリエントリを読み込もうとします。

----------------------------------------------------------------------
dtコマンド
----------------------------------------------------------------------
- SDK200 より以前の dtcparam コマンドを使用して boot=dbg を設定した場合、
  SDK200 以降の dtcparam コマンドを使用して起動パラメータの表示を行なうと  
  boot=unknown と表示されます。
  SDK200 以降の dtcparam コマンドを使用し、再設定してください。

----------------------------------------------------------------------
SPU Runtime Library
----------------------------------------------------------------------
<libspurs ジョブ>
(Release 250.001 追加)
- (B#61734)
  cellSpursCheckJob() には以下の制限事項があります。
   - ジョブディスクリプタヘッダのjobTypeにCELL_SPURS_JOB_TYPE_MEMORY_CHECK
     をセットしたジョブディスクリプタで、入力・入出力バッファ、出力バッファの
     いずれかのサイズがゼロであった場合に、実際にはCELL_OKを返すべき時に
     CELL_SPURS_JOB_ERROR_MEMORY_SIZEを返す場合があります。
     cellSpursJobQueueCheckJob()では上記に加えてスクラッチバッファのサイズが
     ゼロの場合にもこの不具合が発生します。

----------------------------------------------------------------------
NPマッチング2ユーティリティ
----------------------------------------------------------------------
(Release 250.001 追加)
- 誰も参加していないロビーに 2人のユーザが同時に参加しようとすると、
  それぞれが別のロビーに入ってしまう不具合があります。なお、参加が
  成功した後、双方に通知するサーバーID、ワールドID、ロビーID、
  ロビーメンバーIDは一緒です。

(Release 250.001 追加)
- sceNpMatching2SignalingGetPingInfo() は指定した
  ルームID のルームオーナーに対する RTT を取得する関数
  です。しかし、ルームオーナーが NATタイプ1、もしくは 
  NATタイプ2 であっても、外部ネットワークから直接アクセス
  可能な場合を除いて、ほとんどのケースで関数からタイム
  アウトエラー(SCE_NP_SIGNALING_ERROR_TIMEOUT)が返る
  不具合があります。
 （技術情報ID:200810-16  https://ps3.scedev.net/technotes/view/820）

----------------------------------------------------------------------
Control Console
----------------------------------------------------------------------
- Control Console Client ライブラリはVisual Studio 2005環境でのみ利用可能です。

----------------------------------------------------------------------
libad
----------------------------------------------------------------------
(Release 250.001 追加)
- (B#60616)
  asyncライブラリの競合状態は、sceAdAsyncSpaceOpen() と 
  sceAdAsyncSpaceClose() が不安定になる原因となります。タイトルが
  クラッシュする可能性があるので、全てのタイトルにおいてこの関数を
  呼び出さないようにし、ad ローテーション用にライブラリで提供されている
  メカニズムは使用しないでください。代わりに、sceAdGetSpaceInfo() または 
  sceAdGetAssetInfo() を呼び出し、独自のタイマーを管理し、手動で 
  ad ローテーションを実行してください。

----------------------------------------------------------------------
libmstream
----------------------------------------------------------------------
(Release 250.001 追加)
- simple_createdsp_td及びdsp_sampleサンプルにおける
  "SNC Release"ビルド構成において、出力ファイル名が正しくないため
  ビルドした実行ファイルの実行に失敗するという不具合があります。

  プロジェクトのプロパティより、出力する実行ファイル名を".self"から
  ".elf"に変更することで、サンプルを実行することが出来ます。

- 単一のDSPページのサイズの最大は12KBに制限されます。
  DSPの関数を使用する場合、filesizeとして指定するファイルサイズの長さは
  12KBを越えることができません。
  なお、単一のDSPページのサイズの最大値は、mstream.hのCELL_MS_DSP_PAGESIZE
  にて定義しています。

- cellMSSystemConfigureSysUtil()は、今後廃止を予定していますので、
  ゲームアプリケーションでは、SDK200.002 で追加しました
  cellMSSystemConfigureSysUtilEx()への移行をお願いします。

- タイムドメインモードにおいて、24khzより低いサンプリング周波数のADPCM
  データはノイズが発生してしまう不具合があります。

- 各サンプルをSNCコンパイラを使用してコンパイルした場合、ロードする
  サンプルデータのパスに環境変数CELL_SDKを使用しているため、
  サンプルデータが正しくロードできない場合があります。

  CELL_SDK を"\usr\local\cell\"以外にしている場合には、サンプルソース内の
  SAMPLE_CELL_SDK のパスを使用している環境にあわせて適宜変更してください。

  この問題は、GCC コンパイラを使用している場合は問題ありません。

----------------------------------------------------------------------
vectormath
----------------------------------------------------------------------
(Release 250.001 追加)
- PPU 版 C/C++ 標準ライブラリの SIMD 数値演算関数 cbrtf4(vector float) に
  精度問題が見つかりました。
  Vectormath 関数 cbrtf(floatInVec) はこの関数を使用しているため、
  PPU 版で同様の精度問題があります。

----------------------------------------------------------------------
DECI3 CTRLP
----------------------------------------------------------------------
(Release 250.001 追加)
- v250.1 以降の ProDG Target Manager for PLAYSTATION(R)3 はCTRLPに
  接続します。
  そのため、ProDG Target Manager for PLAYSTATION(R)3 をターゲットに
  接続していると cell\host-common\samples\ctrlp サンプルプログラムは
  動作しません。
  起動すると"dt_register error" と表示され、サンプルプログラムは終了します。

  ctrlpサンプルを動作させる場合は、ProDG Target Manager for PLAYSTATION(R)3
  を切断してください。

----------------------------------------------------------------------
libvoice
----------------------------------------------------------------------
(Release 250.001 追加)
- SDKドキュメントの CellVoiceStart() と CellVoiceStartEx() には以下の
  エラーコードが記載されていますが、実際はこれらの値を返しません。

  - CELL_VOICE_ERROR_SERVICE_ATTACHED
  - CELL_VOICE_ERROR_SERVICE_DETACHED

  「libvoice 概要」における「libvoiceのメモリ構成」の記述もこの変更を
  反映していません。

