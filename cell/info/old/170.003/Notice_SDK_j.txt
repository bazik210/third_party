[SCE CONFIDENTIAL DOCUMENT]
PLAYSTATION(R)3 Programmer Tool Runtime Library 170.003
                    Copyright(C) 2007 Sony Computer Entertainment Inc.
                                                   All Rights Reserved.
======================================================================
以下にReference Tool SDKパッケージに関する既知の不具合・制限事項・注意事項を
記述します。

新規に更新した箇所にリリースバージョンを追加しましたので参照してください。

----------------------------------------------------------------------
Reference Tool
----------------------------------------------------------------------
- RSX(R)から音声出力を行うプログラムを動作させるときに、以下のいずれかの
  操作行うと、音声出力されないという不具合があります。
  - HDMIケーブルの抜き差しを行う
  - TVモニタ（AV Amp含む）の電源のOff→On
  - TVモニタ（AV Amp含む）のチャネルを切り替えて、再度HDMI入力に設定する

- 以下のデバイスは現在サポートされておりません。

  - CompactFlash(R)
  - SDメモリーカード
  - FOOT SW

  無線機能(Bluetooth(R)/Wireless LAN)は Reference Toolの認証取得の関係から
  DEH-R1040 以降の Reference Tool 以外で使用する事が出来ません。
  アンテナは DEH-1040 以降のReference Tool に同梱されておりますので、
  DEH-R1030 以前の Reference Tool には接続しないでください。

- Reference Tool の各スペックに関しては、
  info/Reference_System-Supplement_*.pdfを参照してください。

----------------------------------------------------------------------
CBE仕様
----------------------------------------------------------------------
- 現在、各機種とも、搭載CBEはSPU 6個が使用可能となっています。

----------------------------------------------------------------------
システムソフトウェア(GUI) 
----------------------------------------------------------------------
- デバッガ起動時の電源オフ処理時にプロセス終了待ちが行われるように
  なった為、ゲームアプリケーションの終了処理に対応していない幾つかの
  サンプルにおいて、デバッガ起動時に電源オフ処理を行うとタイムアウトが
  発生し、警告音とともにシステムが強制終了してしまう不具合があります。 

----------------------------------------------------------------------
システムユーティリティ
----------------------------------------------------------------------
< Web Browserユーティリティ >
- ダウンローダを使用したファイルのダウンロードができません。

- コンテンツ用ヒープ領域の上限に近い状態で画像のデコードが
  行われると終了時にハングアップすることがあります

- JavaScript の onMouseOver/onMouseOut ハンドラは正しく動作しません。
  onFocus/onBlur を使用してください。

- ClickableMapの使用によって動作が遅くなることがあります。

< On-Screen Keyboard ユーティリティ>
- オプション辞書機能は未対応です。

----------------------------------------------------------------------
BDエミュレータ(HDD)
----------------------------------------------------------------------
- Windows 上で BD エミュレータをご利用になる際、dtcfsutil.exeを使う際、
  msys 上では動作いたしません。
  コマンドプロンプト上で dtcfsutil.exe を使用してください。
  なお、Linux 上では問題ありません。
  また、BDエミュレータ用HDD のフォーマットを行なう際にも上記の制限が
  あります。

----------------------------------------------------------------------
ファイルシステム
----------------------------------------------------------------------
<cellftp>
- put コマンドのオプション -u は、指定しても正しく動作いたしません。 

- copy コマンド、及び copydir コマンドのオプション -u を
  指定してもコピー先が HOSTFS の場合には正しく動作いたしません。

----------------------------------------------------------------------
libftp
----------------------------------------------------------------------
- 2個以上のストリームを同時に転送すると、転送速度が大幅に遅くなります。

----------------------------------------------------------------------
Cell OS Lv-2
----------------------------------------------------------------------
- sys_memory_container_create() にて上限数以上のメモリコンテナを 
  作ろうとすると、新しいメモリコンテナに対して、既に割り当て済の 
  メモリコンテナと同じ ID が返される不具合が発生します。この時、 
  古い方のメモリコンテナは sys_memory_container_destroy() にて 
  破棄することができず、ゲームプロセス終了時にもシステムによって 
  回収されない可能性があります。 

  [回避策] 
  ゲームプロセスにて生成するメモリコンテナの数は、必ず、 
  同時には10個以内になるようにしてください。 

----------------------------------------------------------------------
CODEC
----------------------------------------------------------------------
<libvdec>
- サンプルは、SXGA以上の解像度を持つPCモニタないし1280x720/60p入力に
  対応したHDMIモニタへの出力が前提となっています。このためsetmonitor
  ユーティリティで予め適切にモニタ設定がなされていない場合には、警告の
  メッセージを表示します。

<libdmux>
- cellDmuxDisableEs()を呼び出す場合、video/audio decoderが該当のES
  (エレメンタリストリーム)をデコードしていないことを確認した上で、
  呼び出すようにしてください。
  具体的には、video/audio decoderへ入力したAUに対する
  CELL_VDEC_MSG_TYPE_AUDONE/CELL_ADEC_MSG_TYPE_AUDONEを全て受信した後、
  もしくはcellVdecClose()/cellAdecClose()の呼出し完了後に
  cellDmuxDisableEs()を呼び出すことが推奨されます。

<libvpost>
- サンプルは、SXGA以上の解像度を持つPCモニタないし1280x720/60p入力に
  対応したHDMIモニタへの出力が前提となっています。このためsetmonitor
  ユーティリティで予め適切にモニタ設定がなされていない場合、エラー
  メッセージを表示し、途中で終了します。

<libjpgdec>
- サンプルは、SXGA以上の解像度を持つPCモニタないし1280x720/60p入力に
  対応したHDMIモニタへの出力が前提となっています。このためsetmonitor
  ユーティリティで予め適切にモニタ設定がなされていない場合、エラー
  メッセージを表示し、途中で終了します。

<libpngdec>
- サンプルは、SXGA以上の解像度を持つPCモニタないし1280x720/60p入力に
  対応したHDMIモニタへの出力が前提となっています。このためsetmonitor
  ユーティリティで予め適切にモニタ設定がなされていない場合、エラー
  メッセージを表示し、途中で終了します。

- cellPngDecReadHeader()の引数「CellPngDecInfo *info」で取得する
  info->colorSpaceの値がCELL_PNGDEC_GRAYSCALE_ALPHAまたは
  CELL_PNGDEC_RGBAとなるストリームをデコードする場合において、
  以下の不具合があります。

  cellPngDecSetParameter()の引数「CellPngDecInParam *inParam」で
  inParam->outputAlphaSelectをCELL_PNGDEC_FIX_ALPHAと設定した場合、
  inParam->outputColorAlphaで設定した固定のアルファ値がデコード画像に
  出力されず、ストリームのアルファ値がデコード画像に出力される
  不具合。

- cellPngDecReadHeader()の引数「CellPngDecInfo *info」で取得する
  info->colorSpaceの値がCELL_PNGDEC_PALETTEとなり、
  info->chunkInformationのtRNSチャンクが存在することを示すビットが
  1となるストリームをデコードする場合において、以下の不具合があります。

  cellPngDecSetParameter()の引数「CellPngDecInParam *inParam」で
  inParam->outputColorSpaceにCELL_PNGDEC_PALETTE以外の設定を行うと、
  cellPngDecGettRNS()の引数「CellPngTRNS *trns」で取得する
  trns->alphaForPaletteIndexとtrns->alphaForPaletteIndexNumber
  の値が0になる不具合。

----------------------------------------------------------------------
libfont
----------------------------------------------------------------------
- グリフ情報の取得関数で生成したグリフ情報と、グリフ情報からレンダリング
  する関数に指定するサイズの大きさやアスペクト比に、大きな差がある場合、
  以下の問題があります。

  グリフ情報からの縦書きレンダリング関数 cellFontGlyphRenderImageVertical()で
  正しい位置にレンダリングされない問題。

- 縦書き用関数は、中国語用配置が未サポートとなっています。
  また、内部の縦書き用文字置き換えで、全角(){} が、縦書き用文字コードに
  置き換わりません。
  直接縦書き用文字コードを指定するか、半角(){} を使用してください。


----------------------------------------------------------------------
C/C++標準ライブラリ 
----------------------------------------------------------------------
- PPU側のプログラムをコンパイルする際に、以下のコンパイルオプションを
  指定すると大量にwarningが出力される場合があります。

  -Wall -Wundef -Wundef -Wsystem-headers -Wcast-qual

- math.h をインクルードした SPU プログラムをコンパイルする際において、
  コンパイルオプションとして -fsingle-precision-constant を指定すると
  エラーが発生します.

- システムヘッダをインクルードする際には extern "C" または extern "C++"
  の外側で行ってください.

  例えば以下のようなプログラムをコンパイルするとエラーとなる場合があります.

    extern "C" {
      ...

      #include <yyyy> // NG : extern "C" の内側でインクルードしている

      ...
    }

  上記のようなプログラムは以下のように書き換えることによりエラーを回避できます.

    #include <yyyy>
    extern "C" {

      ... 

    }

<PPU>
- atexit関数の使用方法に、以下の制限があります。

  * atexit関数でPRXモジュール内の関数を登録し、PRXモジュールの終了処理を
    行った後で、main関数を終了、もしくはexit 関数を呼び出すと、DSI(data 
    storage interrupt)が発生します。

  * C++のグローバルコンストラクタでatexit関数を使用した場合、C++の
    言語仕様と異なり、登録された全ての関数は、全てのグローバル
    デストラクタに先だって実行されます。

<PPU>
- PRX中で、クラスios_baseまたはその派生クラス(fstream, iostream,
  stringstream, strstreamなど)を使用する場合には、オブジェクトの生成は
  ELF側で行い、それへのポインタをPRX側に渡すようにしてください。PRX側で
  生成を行った場合には、PPUプログラムの終了時に_Fac_tidy()関数でDSI(data 
  storage interrupt)が発生する可能性があります。

<SPU>
- スタックまたはヒープ領域を大量に使うことにより、ヒープ領域を破壊してし
  まう場合があります。SPU ABIでは、スタックポインタから正のオフセットの
  メモリに加えて、-2000までの負のオフセットのメモリの使用を許可していま
  すが、不具合により、負のオフセットの使用が保証できないことがあります。
  スタックポインタからの負のオフセットは、spu_printf()、リーフ関数などで
  使用されています。

----------------------------------------------------------------------
SPU Runtime Library
----------------------------------------------------------------------
<libspurs task>
- cellSpursWaitSignal関数はコンテキスト領域が設定されていないタスクから
  呼び出された場合は、エラーコードCELL_SPURS_TASK_ERROR_STATを返す仕様
  ですが、タスクにシグナルが存在している場合は必ずCELL_OKを返す
  不具合があります。

<libspurs policy module>
(Release 170.003 追加)
- SPU用cellSpursShutdownWorkload()がshutdownリクエスト済みの
  ワークロードに対しエラーを返します。

- cell/target/spu/include/cell/spurs/policy_module.hに記載されている
  cellSpursModuleTrace()は現在サポートされていません。
  今後、ヘッダファイルの記述から削除する予定です。

<libdaisy>
(Release 170.003 追加)
- 以下のクラスでdmaTagRangeMaskを設定した場合に、正しく使用される
  DMAタグの範囲が指定できません。
   Buffer::Remote,Buffer::StrideRemote,QueueControl::SignalNotification

----------------------------------------------------------------------
Vector Math
----------------------------------------------------------------------
- Vector Mathライブラリの平方根や平方根の逆数を計算する関数は、
  精度よりも速度を重視しているため、IEEE 基準のfloat型の演算精度を
  満たしておりません。

----------------------------------------------------------------------
libcamera
----------------------------------------------------------------------
- 他のUSBデバイスの抜き差しが行われると、切り替え時にいくつかの
  ビデオフレームが失われる場合があります。

----------------------------------------------------------------------
libmic
----------------------------------------------------------------------
- システムのエコーキャンセラーは、USBスピーカーをサポートしていません。
  USB スピーカーに出力する場合にオーディオチャットがエコーフィードバック、
  またはハウリングを引き起こす可能性があります。

----------------------------------------------------------------------
USB
----------------------------------------------------------------------
<USBドライバ>
- 本体USBポートにおけるデバイスの抜き差しにより、本体USBポートに
  接続されている他のUSBデバイスのデータ通信が乱れたり、切断されてしまう
  ことがあります。
  回避方法としては、自己電源(セルフパワー)HUBを本体USBポートに
  接続するようにしてください。

---------------------------------------------------------------------
Cg Compiler
---------------------------------------------------------------------
(Release 170.003 追加)
- cgbファイルを生成する際にフラグメントシェーダ内のマトリクスパラメータ
  を正しくハンドルできていないという不具合があります。

