[SCE CONFIDENTIAL DOCUMENT]
PLAYSTATION(R)3 Programmer Tool Runtime Library 210.001
                    Copyright(C) 2007 Sony Computer Entertainment Inc.
                                                   All Rights Reserved.
======================================================================
以下にReference Tool SDKパッケージに関する既知の不具合・制限事項・注意事項を
記述します。

新規に更新した箇所にリリースバージョンを追加しましたので参照してください。

----------------------------------------------------------------------
Reference Tool
----------------------------------------------------------------------
- RSX(R)から音声出力を行うプログラムを動作させるときに、以下のいずれかの
  操作行うと、音声出力されないという不具合があります。
  - HDMIケーブルの抜き差しを行う
  - TVモニタ（AV Amp含む）の電源のOff→On
  - TVモニタ（AV Amp含む）のチャネルを切り替えて、再度HDMI入力に設定する

- 以下のデバイスは現在サポートされておりません。

  - CompactFlash(R)
  - SDメモリーカード
  - FOOT SW
    ただし、PA Suite 1.3.0以降のPA Suiteでサポートしております。

- Reference Tool の各スペックに関しては、
  SDK_doc/jp(en)/pdf/development_basic/Reference_System-Supplement_*.pdfを
  参照してください。

----------------------------------------------------------------------
CBE仕様
----------------------------------------------------------------------
- 現在、各機種とも、搭載CBEはSPU 6個が使用可能となっています。

----------------------------------------------------------------------
システムソフトウェア(GUI)
----------------------------------------------------------------------
(Release 210.001 追加)
- 設定 -> Debug Settings -> Core Dump メニューにおいて、コアダンプの
  プロセスメモリ情報は仮想メモリ領域に対応しておりません。
  今後のリリースで対応予定です。

(Release 210.001 追加)
- ゲーム列のCheckメニューにおいて、ディスク起動ゲーム上のEBOOT.BINの
  チェック機能は対応しておりません。
  今後のリリースで対応予定です。

----------------------------------------------------------------------
システムユーティリティ
----------------------------------------------------------------------
< ゲームアップデートユーティリティ >
-  管理ツールなどで設定する起動パラメータに"デバッガモード"を選択して
   起動させた Reference Tool では、ゲームアップデートユーティリティ
   のパッチ配信機能を使用することはできません。

< コンテンツ検索ユーティリティ >
- cellSearchPrepareFile()でコンテンツの静止画サムネイル及び
  動画サムネイルのファイルパスを作成した後、そのコンテンツの
  サムネイルをシステムソフトウェア等から変更した場合、再度
  cellSearchPrepareFile()を実行しないとその変更が反映されません。

< メッセージダイアログユーティリティ >
(Release 210.001 追加)
- (B#42912)
  cellMsgDialogOpen2() の引数に渡す文字列が UTF-8 以外の文字列の場合、
  エラーを返さずに正常終了扱いとなってしまいます。
  また、引数に渡した文字列は表示されずに以下のメッセージダイアログが
  表示されてしまいます。

    「エラーが発生しました。
      (8002B301)」

  なお、SDK200 までは(8002B301)の部分は(FFFFFFFF)となっています。

< リモートプレイユーティリティ >
- (B#41848)
  PLAYSTATION(R)3システムソフトウェアのバージョン2.10でリモートプレイを
  行うには、PSP(R)システムソフトウェアのバージョン3.72以降が必要です。

< アクセスポイントユーティリティ >
(Release 210.001 更新)
- PSP(R)との接続を確認するためには、PSP(R) SDK3.80よりリリース予定の
  ps3scanユーティリティを使用する必要があります。

< サブディスプレイユーティリティ >
- (B#41848)
  サブディスプレイユーティリティを利用する場合は、PSP(R)側の
  システムソフトウェアが3.72以降である必要があります。

< セーブデータユーティリティ >
- cellSaveDataListDelete() でリスト表示されたデータのサムネイル横に
  表示される文字列に関して、dirNamePrefix に指定した値が、

      "*" の場合、"タイトル" が表示される
      それ以外の場合、"サブタイトル" が表示される

  となるのが正しい挙動ですが、SDK200時点では全て、"タイトル" となっています。
  今後の SDK にて修正予定です。

- cellSaveDataFixedDelete() に対して、
  処理開始／終了時の確認ダイアログを省略するオプションが効かない
  不具合があります。今後の SDK にて修正予定です。

- ユーティリティヘッダ(sysutil_savedata.h)に記述されている
  各種API、パラメータにいくつかの制限が設けられています。
  詳細はドキュメント(SaveData-Overview/SaveData-Reference)を
  参照してください。

(Release 210.001 追加)
- 同時に使用できないユーティリティの呼び出し中にセーブデータユーティリティの
  APIを呼び出すと、先に呼び出されていたユーティリティが終了するまで、ブロック
  するという制限事項があります。
  なお、同時に使用できないユーティリティにつきましては、「libsysutil 概要」の
 「同時に使用できないシステムユーティリティ」を参照してください。

< ユーザ情報ユーティリティ >
- 以下のAPIにおいて、初期フォーカス位置の指定が現状出来ないという
  制限事項があります。

  cellUserInfoSelectUser_SetList()
  cellUserInfoSelectUser_ListType()

< On-Screen Keyboard ユーティリティ>
- オプション辞書機能は未対応です。

< Web Browserユーティリティ >
- ダウンローダを使用したファイルのダウンロードができません。

- JavaScript の onMouseOver/onMouseOut ハンドラは正しく動作しません。
  onFocus/onBlur を使用してください。

- ClickableMapの使用によって動作が遅くなることがあります。

< オーディオ設定ユーティリティ >
- cellAudioInGetAvailableDeviceInfo() は、
  "PlayStation 2" 専用 "EyeToy" USB カメラ/PLAYSTATION(R)Eye などの
  デバイスに対応していません。今後のリリースで対応します。

- マルチマイクモードでは、まず、ゲームアプリケーションが利用を希望する音声
  入力デバイスの型を引数deviceTypeに指定してcellAudioInRegisterDevice()を
  実行し、音声入力デバイスをシステムへ登録します。
  cellAudioInRegisterDevice()を呼び出すと与えられた型にマッチする音声入力
  デバイス の有る無しにかかわらず、システムソフトウェアによって自動的にデ
  バイス番号が、その音声入力デバイスに割り当てられます（そのデバイス番号の
  音声入力デバイスが利用可能になった事はlibmicの cellMicIsAttached() を使
  ってポーリングを行って調べるか、libmicのイベントによる通知で知ることがで
  きます）。

  上記の通り、デバイス番号が自動的に割り当てられる為、ゲームアプリケーション
  が使用する型のUSBデバイス(音声入力デバイス)がPLAYSTATION(R)3に複数接続され
  ている場合は、どのUSBポートのデバイスが、どのデバイス番号に割り当てられて
  いるかを一意に判別する事が出来ません。
  この場合は画面にメーター(ボリューム)等を表示するなどして、ユーザインター
  フェース側で判断出来るようにして下さい。
  なお、今後のリリースにおいて特定のデバイスに明示的にデバイス番号を割り当て
  るような仕組みを提供する予定です。

< ミュージックユーティリティ >
(Release 210.001 追加)
- ミュージックユーティリティの再生機能とNPフレンドリストユーティ
  リティを同時に使用する際にゲームアプリケーションがハングアップ
  する事があります。問題が起こる手順は以下の通りです。

  1.cellMusicInitialize()を呼び出して再生機能の初期化を行う
  2.sceNpFriendlist() または sceNpFriendlistCustom() を呼び出して
    NPフレンドリストユーティリティのGUIを呼び出そうとした時点で
    ゲームアプリケーションがハングアップ

< ビデオ設定ユーティリティ >
(Release 210.001 追加)
- 特定のタイミングで cellVideoOutSetGamma() を呼ぶことにより、ゲーム
  アプリケーションのビデオ出力のミュートが解除されず、画面がブラック
  アウトの状態のままになることがあります。

----------------------------------------------------------------------
libnet
----------------------------------------------------------------------
(Release 210.001 追加)
- (B#43301)
  ネットワークのカーネルワークエリアが不足すると、送信関数などで
  永久にブロックしてしまうことがあります。

----------------------------------------------------------------------
NPフレンドリストユーティリティ
----------------------------------------------------------------------
(Release 210.001 追加)
- ミュージックユーティリティの再生機能とNPフレンドリストユーティ
  リティを同時に使用する際にゲームアプリケーションがハングアップ
  する事があります。問題が起こる手順は以下の通りです。

  1.cellMusicInitialize()を呼び出して再生機能の初期化を行う
  2.sceNpFriendlist() または sceNpFriendlistCustom() を呼び出して
    NPフレンドリストユーティリティのGUIを呼び出そうとした時点で
    ゲームアプリケーションがハングアップ

----------------------------------------------------------------------
NPベーシックユーティリティ
----------------------------------------------------------------------
(Release 210.001 追加)
- 構造体 SceNpBasicMessageDetails の mainType に
  SCE_NP_BASIC_MESSAGE_MAIN_TYPE_INVITE を指定して
  sceNpBasicSendMessageGui() を呼ぶと、
  SCE_NP_BASIC_EVENT_SEND_INVITATION_RESULT イベントではなく
  SCE_NP_BASIC_EVENT_SEND_ATTACHMENT_RESULT イベントが発生する
  不具合があります。

  構造体 SceNpBasicMessageDetails の mainType に
  SCE_NP_BASIC_MESSAGE_MAIN_TYPE_INVITE を指定した場合には
  SCE_NP_BASIC_EVENT_SEND_ATTACHMENT_RESULT イベントも
  SCE_NP_BASIC_EVENT_SEND_INVITATION_RESULT イベントと
  同様に扱ってください。

----------------------------------------------------------------------
NPスコアランキングユーティリティ
----------------------------------------------------------------------
(Release 210.001 追加)
- 現在クラン対応ランキングの本番サーバが未提供のため、クラン対応
  ランキングを使用したゲームタイトルをマスターアップすることは出来ません。

(Release 210.001 追加)
- クラン対応ランキングの開発サーバが使用できるようになるのは
  2007/12/25 からとなります。

----------------------------------------------------------------------
BDエミュレータ(HDD)
----------------------------------------------------------------------
- Windows 上で BD エミュレータをご利用になる際、dtcfsutil.exeを使う際、
  msys 上では動作いたしません。
  コマンドプロンプト上で dtcfsutil.exe を使用してください。
  なお、Linux 上では問題ありません。
  また、BDエミュレータ用HDD のフォーマットを行なう際にも上記の制限が
  あります。

----------------------------------------------------------------------
dtコマンド
----------------------------------------------------------------------
(Release 210.001 更新)
- SDK200 より以前の dtcparam コマンドを使用して boot=dbg を設定した場合、
  SDK200 以降の dtcparam コマンドを使用して起動パラメータの表示を行なうと  
  boot=unknown と表示されます。
  SDK200 以降の dtcparam コマンドを使用し、再設定してください。

----------------------------------------------------------------------
Cell OS Lv-2
----------------------------------------------------------------------
- sys_memory_container_create() にて上限数以上のメモリコンテナを 
  作ろうとすると、新しいメモリコンテナに対して、既に割り当て済の 
  メモリコンテナと同じ ID が返される不具合が発生します。この時、 
  古い方のメモリコンテナは sys_memory_container_destroy() にて 
  破棄することができず、ゲームプロセス終了時にもシステムによって 
  回収されない可能性があります。 

  [回避策] 
  ゲームプロセスにて生成するメモリコンテナの数は、必ず、 
  同時には10個以内になるようにしてください。 

- SYS_PROCESS_PARAM によってスタックサイズが 4 KB に設定された
  PPU プログラムは、 main 関数が呼ばれる前に DSI が発生するため、
  プログラムを実行することができません。

  [回避策]
  プライマリ PPU スレッドのスタックサイズは、8 KB 以上を指定するようにして
  下さい。

(Release 210.001 追加)
- sys_vm_memory_map() で生成した仮想メモリを破棄せずにゲームプロセス
  を終了すると、システムが破綻することがあります。

  [回避策]
  sys_vm_memory()で生成した仮想メモリ領域はゲームプロセス終了前に
  sys_vm_unmap()で明示的に破棄してください。

(Release 210.001 追加)
- (B#44762)
  sys_memory_get_page_attribute() は仮想メモリ領域に対応していません。
  仮想メモリ領域のアドレスが渡された場合の返り値は不定です。

----------------------------------------------------------------------
libusbd
----------------------------------------------------------------------
- 本体USBポートにおけるデバイスの抜き差しにより、本体USBポートに
  接続されている他のUSBデバイスのデータ通信が乱れたり、切断されてしまう
  ことがあります。
  回避方法としては、自己電源(セルフパワー)HUBを本体USBポートに
  接続するようにしてください。

----------------------------------------------------------------------
libcamera
----------------------------------------------------------------------
- USB Video Class (UVC)カメラの制限事項
  1. USB 2.0 対応であっても UVC 対応でないカメラはサポートしません。
  2. ストリーミング機能のないカメラはサポートしません。
  3. USB 1.1 ハブ経由で接続したカメラはサポートしません。
  4. ミラー機能はサポートしません。
  5. カメラは 1 台のみサポートします。

----------------------------------------------------------------------
libpad for Windows
----------------------------------------------------------------------
(Release 210.001 追加)
- Windows XP にのみ対応しています。
  Windows Vista には、将来対応する予定です。

----------------------------------------------------------------------
libsail
----------------------------------------------------------------------
- PAMFファイル再生の場合ストリームの終端の数フレーム(1～3枚程度)は
  取得できません。

- MP4ファイルについては、録画ユーティリティで作成され、かつ内蔵HDD上に
  存在するもののみ再生を保障します。それ以外のMP4ファイルを再生する
  コードをアプリケーションに組み込まないでください。

----------------------------------------------------------------------
libfont
----------------------------------------------------------------------
- 縦書き用関数は、中国語用配置が未サポートとなっています。
  また、内部の縦書き用文字置き換えで、全角(){} が、縦書き用文字コードに
  置き換わりません。
  直接縦書き用文字コードを指定するか、半角(){} を使用してください。

----------------------------------------------------------------------
libperf
----------------------------------------------------------------------
- SDK180より前のlibperf.aをリンクしたプログラムで、Lv-2の
  システムコールトレースをバックトレースつきで有効化した場合、
  SDK180以降にシステムアップデートされたターゲットシステム上では
  動作しません。(libperf/ppuサンプルが該当)
  SDK180以降にリリースされているlibperf.aを使用してください。

(Release 210.001 追加)
- (B#43808)
  ターゲット上の計測モジュールを使用するため、libperfのサンプルプログラム
  をPA Suiteで計測することはできません。

----------------------------------------------------------------------
libgcm
----------------------------------------------------------------------
(Release 210.001 追加)
- cellGcmSetZcull()を使ってZcull領域のアンバインドを設定することはできません。
  Zcull領域のアンバインド設定にはcellGcmUnbindZcull()を使用してください。

- cellGcmSetTile()を使用してRSX(R)に対して領域の重なったタイル設定が
  行われた場合、RSX(R)のアドレス変換機能が正しく動作しません。

  このためタイル領域が重なっているかどうかチェックする機能を追加した
  新規関数 cellGcmSetTileInfo()、cellGcmBindTile()を追加しました。

  今後の開発にはcellGcmSetTile()およびcellGcmSetInvalidateTile()の代わりに
  cellGcmSetTileInfo()、cellGcmBindTile()、cellGcmUnbindTile()を
  使用してください。
  cellGcmSetTile()、 cellGcmSetInvalidateTile()は、今後のリリースにおいて
  削除され使用できなくなる予定です。

----------------------------------------------------------------------
GCM Methodマクロ
----------------------------------------------------------------------
(Release 210.001 追加)
- 今回のリリースはベータリリースとします。

(Release 210.001 追加)
- 今後、公開する機能範囲の縮小といった変更はありませんが、
  gcm_method_data.hファイルの名前の変更、マクロの名前変更などの
  可能性があります。

(Release 210.001 追加)
- ゲームタイトルでご利用される場合は、テクニカルサポートまで
  お問い合わせください。 

----------------------------------------------------------------------
PSGL
----------------------------------------------------------------------
(Release 210.001 追加)
- 16ビットデプスバッファを使用した場合はライブラリ内部にてTiled -> Swizzled ->
  Linearの優先順位にて設定が行われます。
  しかしながらSwizzledの設定を使用する場合はカラーバッファとデプスバッファの
  pixelのビット数が同一である必要があります（RSX(R)のハードウェア上の制限）。
  その為、32bitカラーと16bitデプスバッファを併用した場合は内部で「暗黙的に」
  Swizzledの設定が採用されるとRSX(R)がクラッシュする場合があります。

----------------------------------------------------------------------
SPU Runtime Library
----------------------------------------------------------------------
<libspurs タスク>
- SPURSタスクが同期オブジェクトを呼び出した際に以下の条件を満たすと
  動作が不定になる不具合があります。

  - 待ち状態になる条件を満たしている
  - コンテキスト保存領域は設定されているがLSパターンに
    stack領域が含まれていない

  このとき、CELL_SPURS_TASK_ERROR_STATが返りますが、呼び出した
  同期オブジェクトの状態が壊れ、この同期オブジェクトに対する
  以後の呼び出しは動作不定になります。
  また、呼び出したSPURSタスクはエラーを受けた後、待ち状態になる
  インタフェースを呼ぶと動作不定になります。

----------------------------------------------------------------------
C/C++標準ライブラリ 
----------------------------------------------------------------------
(Release 210.001 追加)
<PPU/SPU>
- ある条件を満たす状況でソースファイルをコンパイルすると、次のような警告が
  報告されます。-Werrorオプションを指定していると、警告ではなくエラーとして
  報告されます。

  --------------------------------------------------------------
  C:/usr/local/cell/target/ppu/include/bits/sce_math.h:13 から include された
  ファイル中,
                 C:/usr/local/cell/target/ppu/include/math.h:1468 から,
                 c:/usr/local/cell/target/ppu/src/PSGL/jetstream/src/Image.cpp:17 から:
  C:/usr/local/cell/target/ppu/include/vec_types.h(44,1): error: "vec_uint4" 
  が再定義されました
  --------------------------------------------------------------

  この問題が発生するのは以下の(a)-(c)をすべて満たす場合です
  (a) Windows版でコンパイルしている
  (b) SN社製VSI環境を使っている or VSIを使ってないが-Wsystem-headersオプション
      を指定している
  (c) stdlib.h, vec_types.hの順でヘッダファイルをインクルードしている

  [回避策] 
  この問題を回避するには、(c)の条件を満たさないように
     #include <vec_types.h>
     #include <stdlib.h>
  という順序でソースファイルを書き換えることで対処できます。

  この不具合はSDK220のリリースにおいて修正致します。

(Release 210.001 追加)
<SPU>
- (B#20077) 
  C++でnew_handlerを設定していない場合、newでメモリを割り当てに失敗すると
  無限ループになります。

- PPU側のプログラムをコンパイルする際に、以下のコンパイルオプションを
  指定すると大量にwarningが出力される場合があります。

  -Wall -Wundef -Wundef -Wsystem-headers -Wcast-qual

- math.h をインクルードした SPU プログラムをコンパイルする際において、
  コンパイルオプションとして -fsingle-precision-constant を指定すると
  エラーが発生します.

- システムヘッダをインクルードする際には extern "C" または extern "C++"
  の外側で行ってください.

  例えば以下のようなプログラムをコンパイルするとエラーとなる場合があります.

    extern "C" {
      ...

      #include <yyyy> // NG : extern "C" の内側でインクルードしている

      ...
    }

  上記のようなプログラムは以下のように書き換えることによりエラーを回避できます.

    #include <yyyy>
    extern "C" {

      ... 

    }

<PPU>
- <iostream>をインクルードしたプログラムのスタートアップ時には、iostreamの
  コンストラクタがnew演算子を呼び出します。main関数実行前のnewの呼び出しを
  避けたい場合は、iostreamを利用しないようにしてください。

<PPU>
- atexit関数の使用方法に、以下の制限があります。

  * atexit関数でPRXモジュール内の関数を登録し、PRXモジュールの終了処理を
    行った後で、main関数を終了、もしくはexit 関数を呼び出すと、DSI(data 
    storage interrupt)が発生します。

  * C++のグローバルコンストラクタでatexit関数を使用した場合、C++の
    言語仕様と異なり、登録された全ての関数は、全てのグローバル
    デストラクタに先だって実行されます。

<PPU>
- PRX中で、クラスios_baseまたはその派生クラス(fstream, iostream,
  stringstream, strstreamなど)を使用する場合には、オブジェクトの生成は
  ELF側で行い、それへのポインタをPRX側に渡すようにしてください。PRX側で
  生成を行った場合には、PPUプログラムの終了時に_Fac_tidy()関数でDSI(data 
  storage interrupt)が発生する可能性があります。

<SPU>
- スタックまたはヒープ領域を大量に使うことにより、ヒープ領域を破壊してし
  まう場合があります。SPU ABIでは、スタックポインタから正のオフセットの
  メモリに加えて、-2000までの負のオフセットのメモリの使用を許可していま
  すが、不具合により、負のオフセットの使用が保証できないことがあります。
  スタックポインタからの負のオフセットは、spu_printf()、リーフ関数などで
  使用されています。

----------------------------------------------------------------------
サンプルプログラム(cell/samples)
----------------------------------------------------------------------
(Release 210.001 追加)
- サンプルに付属するVisual Studio 2003のソリューションファイル、
  プロジェクトファイルをVisual Studio 2005に変換した後、
  Visual Studio 2005上でビルドを行う場合、以下の設定を行なってください。

  [ツール]タブより[オプション]を選択し、[プロジェクトおよびソリューション]の
  [ビルド/実行]から設定可能な[並行にビルドするプロジェクトの最大数]を 1 に
  設定してください。
  この最大数が 2 以上の場合、まれにビルドに失敗することがあります。

(Release 210.001 追加)
- Framework.vcprojを含むソリューションファイルを、VisualStudio2003
  からVisualStudio2005に変換した際、VisualStudio2003のソリューション
  ファイルには存在しなかったビルド構成が変換時に追加される問題があり
  ます。

----------------------------------------------------------------------
libftp
----------------------------------------------------------------------
- 2個以上のストリームを同時に転送すると、転送速度が大幅に遅くなります。

- Internet Explorer 6.0 を使用した場合に接続に失敗する場合があります。

- Passive transfer mode (PASV)は、現在サポートしていません。

----------------------------------------------------------------------
libscream
----------------------------------------------------------------------
(Release 210.001 追加)
- SCREAMライブラリは cellScreamMSSync()を使用して、ステータスの更新、
  及び同期を行います。 通常、この関数はcellScreamSetMasterVolume()などの
  更新関数とは別に呼び出しを行います。
  しかし、これらの関数を別々のPPUスレッドから呼び出すと、内部データが破損し、
  続いてゲームアプリケーションが停止する場合があります。 

  回避方法 
  この不具合はcellScreamMSSync()及びパラメータ更新関数
  (cellScreamSetMasterVolume()等）に対してミューテックスなどの
  同期プリミティブを使用し、排他的に呼ぶ事で回避可能です。

----------------------------------------------------------------------
libmstream
----------------------------------------------------------------------
(Release 210.001 追加)
- cell/samples/sdk/sound/multistream/dspeffects 以下に *.pic ファイルが
  存在していますが、ゲームアプリケーションでは、
  cell/target/spu/lib/pic/multistream 以下の PPU のオブジェクト
  ファイル(*.ppu.o)を使用してください。

(Release 210.001 追加)
- cellMSSystemConfigureSysUtil()は、今後廃止を予定していますので、
  ゲームアプリケーションでは、SDK200.002 で追加しました
  cellMSSystemConfigureSysUtilEx()への移行をお願いします。

- タイムドメインモードにおいて、24khzより低いサンプリング周波数のADPCM
  データはノイズが発生してしまう不具合があります。

----------------------------------------------------------------------
cgc
----------------------------------------------------------------------
(Release 210.001 追加)
- バーテクスシェーダを-cgbオプション付きでランタイムコンパイルした
  (compile_program_from_string()を使用した)際にattributeOutputMaskと
  userClipMaskの値が0になってしまう不具合があります。
  なお、この問題はPLAYSTATION(R)3用のライブラリでのみ発生します。
  Windows/Linux用のライブラリでは問題は発生しません。

