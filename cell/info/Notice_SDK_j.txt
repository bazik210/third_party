[SCE CONFIDENTIAL DOCUMENT]
PlayStation(R)3 Programmer Tool Runtime Library 320.001
                    Copyright(C) 2010 Sony Computer Entertainment Inc.
                                                   All Rights Reserved.
======================================================================
以下にReference Tool SDKパッケージに関する既知の不具合・制限事項・注意事項を
記述します。

新規に更新した箇所にリリースバージョンを追加しましたので参照してください。

----------------------------------------------------------------------
Reference Tool
----------------------------------------------------------------------
- Reference Tool の各スペックに関しては、
  SDK_doc\jp(en)\pdf\development_basic\Reference_System-Supplement_*.pdfを
  参照してください。

----------------------------------------------------------------------
システムソフトウェア
----------------------------------------------------------------------
<ゲーム列のCheckメニュー>
- ゲーム列のCheckメニューで行なうチェックでは、メディアの検証、
  ファイルシステム自体を検証することはできません。

  マスターディスクを納品する際には、Disc Image Generator for PlayStation(R)3
  またはDisc Image Checker for PlayStation(R)3を用いてマスターディスクの検証を
  行い、エラーが無いことを必ず確認してください。

- ゲーム列のCheckメニューで行なうチェックにおいて、USBマスストレージに
  保存されるチェック結果ファイルの数が80～100個程度を超えると、
  USBマスストレージのルートディレクトリのファイルエントリを使い切って
  しまうために それ以降保存ができなくなることがあります。
  この場合にはいったんチェック結果ファイルを別ディレクトリなどに
  移動させてください。

----------------------------------------------------------------------
システムユーティリティ
----------------------------------------------------------------------
<On-Screen Keyboard ユーティリティ>
- オプション辞書機能は未対応です。

<コンテンツ検索ユーティリティ>
- cellSearchPrepareFile()でコンテンツの静止画サムネイル及び
  動画サムネイルのファイルパスを作成した後、そのコンテンツの
  サムネイルをシステムソフトウェア等から変更した場合、再度
  cellSearchPrepareFile()を実行しないとその変更が反映されません。

<ゲームアップデートユーティリティ>
-  管理ツールなどで設定する起動パラメータに"デバッガモード"を選択して
   起動させた Reference Tool では、ゲームアップデートユーティリティ
   のパッチ配信機能を使用することはできません。

<リモートプレイユーティリティ>
- リモートプレイ対応の携帯電話からPlayStation(R)3に接続した場合、
  PSP(R)とはボタンの数、画面の大きさや解像度などが異なることから
  アプリケーションの起動には対応しておりません。

<オーディオ設定ユーティリティ>
- マルチマイクモードでは、まず、ゲームアプリケーションが利用を希望する音声
  入力デバイスの型を引数deviceTypeに指定してcellAudioInRegisterDevice()を
  実行し、音声入力デバイスをシステムへ登録します。
  cellAudioInRegisterDevice()を呼び出すと与えられた型にマッチする音声入力
  デバイス の有る無しにかかわらず、システムソフトウェアによって自動的にデ
  バイス番号が、その音声入力デバイスに割り当てられます（そのデバイス番号の
  音声入力デバイスが利用可能になった事はlibmicの cellMicIsAttached() を使
  ってポーリングを行って調べるか、libmicのイベントによる通知で知ることがで
  きます）。

  上記の通り、デバイス番号が自動的に割り当てられる為、ゲームアプリケーション
  が使用する型のUSBデバイス(音声入力デバイス)が PlayStation(R)3に複数接続され
  ている場合は、どのUSBポートのデバイスが、どのデバイス番号に割り当てられて
  いるかを一意に判別する事が出来ません。
  この場合は画面にメーター(ボリューム)等を表示するなどして、ユーザインター
  フェース側で判断出来るようにして下さい。
  なお、今後のリリースにおいて特定のデバイスに明示的にデバイス番号を割り当て
  るような仕組みを提供する予定です。

<スクリーンショットユーティリティ>
- PNGのチャンクに設定された値は、システムソフトウェアから外部メディア
 （Memory Stick(TM) など）にコピーしたときにも保存されていますが、
  その保存したものをシステムソフトウェアに取り込んだ場合には、
  値はシステムソフトウェアの情報画面に反映されません。
  これは現時点での制約事項であり、将来のシステムソフトウェアで対応する
  予定です。

<バックグラウンドダウンロードユーティリティ>
- ゲームアプリケーション起動中にもバックグラウンドダウンロードは続行
  しますが、以下の条件においてダウンロードが停止します。

    - ゲームアプリケーションがソケットを 1つ以上作成しているとき
    - NP シグナリングユーティリティを使用したコネクションが 1つ以上
      存在するとき
    - AV チャットユーティリティ、AV チャット 2ユーティリティを
      使用しているとき

  上記条件から外れるとバックグラウンドダウンロードが再開されますが
  バックグラウンドダウンロードの進行状況に依存したゲームアプリケー
  ションの作りにはしないで下さい。

  動作モードを CELL_BGDL_MODE_ALWAYS_ALLOW に変更すると、上記の
  条件でもバックグラウンドダウンロードは継続されます。
 （技術情報ID:200803-15  https://ps3.scedev.net/technotes/view/708）

<Web Browserユーティリティ>
- SDK300 では、インターネットブラウザからの印刷機能が利用できるように
  なりましたが、Web Browser ユーティリティにおいては動作いたしません。

----------------------------------------------------------------------
DECI3 CTRLP
----------------------------------------------------------------------
- v250.1 以降の ProDG Target Manager for PlayStation(R)3 はCTRLPに
  接続します。
  そのため、ProDG Target Manager for PlayStation(R)3 をターゲットに
  接続していると cell\host-common\samples\ctrlp サンプルプログラムは
  動作しません。
  起動すると"dt_register error" と表示され、サンプルプログラムは終了します。

  ctrlpサンプルを動作させる場合は、ProDG Target Manager for PlayStation(R)3
  を切断してください。

----------------------------------------------------------------------
dtコマンド
----------------------------------------------------------------------
- SDK200 より以前の dtcparam コマンドを使用して boot=dbg を設定した場合、
  SDK200 以降の dtcparam コマンドを使用して起動パラメータの表示を行なうと  
  boot=unknown と表示されます。
  SDK200 以降の dtcparam コマンドを使用し、再設定してください。

----------------------------------------------------------------------
libaudio
----------------------------------------------------------------------
- オーディオミックス処理の前にイベント発行する仕組みは、レイテンシ
  センシティブなオーディオストリームを利用するゲームで使用します。
  PPU/SPUからRSX(R)メモリへのアクセスによってシステムタイミングに
  ずれが生じてしまうので、この機能は通常のゲームでは使用しないでください。 

----------------------------------------------------------------------
libmixer
----------------------------------------------------------------------
- cellSurMixerSurBusAddData()の引数 samples に指定するサンプル数は
  4の倍数である必要があります。

----------------------------------------------------------------------
サンプルプログラム
----------------------------------------------------------------------
- gcmのサンプルにおいて cellGcmSetViewport() の設定方法に誤りがありました。
  ただし、サンプルの動作自体に問題はありません。
 （技術情報ID:200808-06  https://ps3.scedev.net/technotes/view/785）

----------------------------------------------------------------------
PlayStation(R)3 Sample Browser 
----------------------------------------------------------------------
- 「Search」ビュー内で検索ヒストリーを使って検索すると、検索テキスト
   フィールドが空白になる。

- 「Contents」ビューで20個以上のサンプルノードを移動すると、
  「Back」ボタンをクリックしても正しいノードに移動しない。

----------------------------------------------------------------------
Toolchain / SPASM
----------------------------------------------------------------------
- (B#62636)
  誤った数の引数でマクロが実行された場合に警告が表示されません。動作は不
  定です。

- (B#62638)
  アセンブルできないほど前に分岐ヒントがスケジューリングされてしまいます。
  この問題はサイズの大きいプログラムで発生する可能性があります。この問題
  を改善するには、-Or (レジスタ最適化)コマンドラインオプションを指定して
  ください。

- (B#71003)
  コメントがネストされていると、SPASMから警告およびエラーが表示されません。

----------------------------------------------------------------------
libmstream
----------------------------------------------------------------------
- 単一のDSPページのサイズの最大は12KBに制限されます。
  DSPの関数を使用する場合、filesizeとして指定するファイルサイズの長さは
  12KBを越えることができません。
  なお、単一のDSPページのサイズの最大値は、mstream.hのCELL_MS_DSP_PAGESIZE
  にて定義しています。

- cellMSSystemConfigureSysUtil()は、今後廃止を予定していますので、
  ゲームアプリケーションでは、SDK200.002 で追加しました
  cellMSSystemConfigureSysUtilEx()への移行をお願いします。

- タイムドメインモードにおいて、24khzより低いサンプリング周波数のADPCM
  データはノイズが発生してしまう不具合があります。

- 各サンプルをSNCコンパイラを使用してコンパイルした場合、ロードする
  サンプルデータのパスに環境変数CELL_SDKを使用しているため、
  サンプルデータが正しくロードできない場合があります。

  CELL_SDK を"\usr\local\cell\"以外にしている場合には、サンプルソース内の
  SAMPLE_CELL_SDK のパスを使用している環境にあわせて適宜変更してください。

  この問題は、GCC コンパイラを使用している場合は問題ありません。

- cell\samples\sdk\sound\multistream\dspeffects\ 以下に *.pic ファイルが
  存在していますが、ゲームアプリケーションでは、
  cell\target\ppu\lib\pic\multistream 以下の PPU のオブジェクト
  ファイル(*.ppu.o)を使用してください。

----------------------------------------------------------------------
libmic
----------------------------------------------------------------------
- Rawストリームの入力のレイテンシを削減する機能は、ゲーム側で
  イベントドリブンスタイルの代わりにマイクデータを取得する
  ポーリングメソッドを使用する際に動作する機能です。
  このレイテンシの改善により、PPUにかなりのオーバーヘッドが生じます。
  この機能は、ゲームにおいてマイクを介したRawデータの入力を低いレイテンシで
  行う必要があるときのみ使用してください。

----------------------------------------------------------------------
libsail
----------------------------------------------------------------------
- MP4ファイルについては、内蔵HDD上に存在するもののみ再生を保障します。
  それ以外のMP4ファイルを再生する コードをアプリケーションに組み込まない
  でください。

- MPEG-4 Advanced Coding Efficiency(M4HD) については、
  録画ユーティリティあるいはlibsail_recで作成されたもののみ再生を保証します。

----------------------------------------------------------------------
libfont
----------------------------------------------------------------------
- 縦書き用関数は、中国語用配置が未サポートとなっています。
  また、内部の縦書き用文字置き換えで、全角(){} が、縦書き用文字コードに
  置き換わりません。
  直接縦書き用文字コードを指定するか、半角(){} を使用してください。

- 縦書き用関数は、プロポーショナルな縦書きレイアウトに未対応となっています。

----------------------------------------------------------------------
libfios
----------------------------------------------------------------------
- Edge ZlibもしくはEdge LZMAを使うには、PlayStation(R)Edge 1.1.1
  をダウンロードし、インストールしてください。

- NPDRMファイルを使用しない場合も、libsysutil_np_stub.aをリンクする必
  要があります。

- アーカイブファイルを作成する際に、アーカイブ対象ファイルと出力ファイ
  ルの名前が同じで、さらに-yもしくは--overwriteオプションが指定された
  場合、アーカイブ対象ファイルが上書きされ復元できなくなります。

----------------------------------------------------------------------
Cell OS Lv-2
----------------------------------------------------------------------
- SYS_PROCESS_PARAM によってスタックサイズが 4 KB に設定された
  PPU プログラムは、 main 関数が呼ばれる前に DSI が発生するため、
  プログラムを実行することができません。

  [回避策]
  プライマリ PPU スレッドのスタックサイズは、8 KB 以上を指定するようにして
  下さい。

----------------------------------------------------------------------
libfs
----------------------------------------------------------------------
- SDK220におけるシステムソフトウェアの使用メモリ量削減の一環として、
  ファイルシステムがデフォルトで使用するメモリ量が削減されました。
  この影響で、細かい単位 (16KB以下)でデータの読み書きを行う場合に、
  SDK21xに比較して、若干性能劣化がある場合があります。また、複数スレッド
  から同時にファイルアクセスするケースではリクエストの処理時間が若干かかる
  場合があります。
  新規追加されましたcellFsSetIoBuffer()などのAPIを使ってアプリケーションから
  メモリを追加することで性能を向上することができることもありますが、
  逆に性能が落ちることもありますので実際に性能を確認してご利用ください。

- (B#47766)
  /dev_hdd0に対してcellFsTruncate()またはcellFsFtruncate()の呼び出しで
  ファイルサイズを0にした場合、その後のファイル操作が永久にブロックされて
  しまう不具合があります。
 （技術情報ID:200804-07 https://ps3.scedev.net/technotes/view/716)

- (B#54524)
  /dev_hdd0に対してcellFsWriteWithOffset()の呼び出しで引数offsetに
  非常に大きな値(8EB以上, 16進数表記で0x8000000000000000ULL以上)を指定した
  場合カーネルがクラッシュしてしまう不具合があります。

- (B#78654)
  システムキャッシュのファイルやディレクトリのオープン処理中に
  cellSysCacheClear()を呼び出すとタイミングによってはカーネルが
  クラッシュする不具合があります。

- (B#78908)
  EDATA/SDATAの読み込みと同時にprxの読み込み、SPU imageの読み込み、
  ゲームプロセスの実行のシステムコールを呼び出すとタイミングによっては
  フリーズする不具合があります。

----------------------------------------------------------------------
librudp
----------------------------------------------------------------------
- (B#79499)
  cellRudpSetOption() を用いて CELL_RUDP_OPTION_RCVBUF 値を設定する際、
  設定可能な最小サイズより小さい値を設定できてしまう不具合があります。
  また、その場合、設定されたコンテキストへ相手が cellRudpWrite() を
  呼び出すと CELL_RUDP_ERROR_MSG_TOO_LARGEエラーが返され送信が
  出来なくなる不具合があります。

- (B#79607)
  cellRudpSetOption() を用いて以下の値を 0x80000000 以上に設定すると
  設定した値を cellRudpGetOption() で取得することができない不具合があります。
  CELL_RUDP_OPTION_READ_TIMEOUT
  CELL_RUDP_OPTION_WRITE_TIMEOUT
  CELL_RUDP_OPTION_FLUSH_TIMEOUT
  CELL_RUDP_OPTION_KEEP_ALIVE_INTERVAL
  CELL_RUDP_OPTION_KEEP_ALIVE_TIMEOUT
  上記値を 0x80000000 以上に設定しないでください。

----------------------------------------------------------------------
libvoice
----------------------------------------------------------------------
- 音声とマイクのバインディングに一貫性がないため、libvoiceの
  マルチマイクモードでの使用は推奨しません。 

----------------------------------------------------------------------
libgcm
----------------------------------------------------------------------
- cellGcmSetZcull()を使ってZcull領域のアンバインドを設定することはできません。
  Zcull領域のアンバインド設定にはcellGcmUnbindZcull()を使用してください。

- cellGcmSetTile()を使用してRSX(R)に対して領域の重なったタイル設定が
  行われた場合、RSX(R)のアドレス変換機能が正しく動作しません。

  このためタイル領域が重なっているかどうかチェックする機能を追加した
  新規関数 cellGcmSetTileInfo()、cellGcmBindTile()を追加しました。

  今後の開発にはcellGcmSetTile()およびcellGcmSetInvalidateTile()の代わりに
  cellGcmSetTileInfo()、cellGcmBindTile()、cellGcmUnbindTile()を
  使用してください。
  cellGcmSetTile()、 cellGcmSetInvalidateTile()は、今後のリリースにおいて
  削除され使用できなくなる予定です。

----------------------------------------------------------------------
C/C++標準ライブラリ 
----------------------------------------------------------------------
<SPU>
- (B#20077) 
  C++でnew_handlerを設定していない場合、newでメモリを割り当てに失敗すると
  無限ループになります。

- PPU側のプログラムをコンパイルする際に、以下のコンパイルオプションを
  指定すると大量にwarningが出力される場合があります。

  -Wall -Wundef -Wundef -Wsystem-headers -Wcast-qual

- システムヘッダをインクルードする際には extern "C" または extern "C++"
  の外側で行ってください。

  例えば以下のようなプログラムをコンパイルするとエラーとなる場合があります。

    extern "C" {
      ...

      #include <yyyy> // NG : extern "C" の内側でインクルードしている

      ...
    }

  上記のようなプログラムは以下のように書き換えることによりエラーを回避できます。

    #include <yyyy>
    extern "C" {

      ... 

    }

<PPU>
- <iostream>をインクルードしたプログラムのスタートアップ時には、iostreamの
  コンストラクタがnew演算子を呼び出します。main関数実行前のnewの呼び出しを
  避けたい場合は、iostreamを利用しないようにしてください。

----------------------------------------------------------------------
カスタムテーマ
----------------------------------------------------------------------
- 効果音データが長すぎる場合、特定の場面で音声が途中で途切れることがあります。
  詳細は、「カスタムテーマ仕様書」を参照ください。

備考：
- 250 のシステムソフトウェアより[設定]列の[BD/DVD設定]メニューが
  [ビデオ設定]メニューに名称が変更になりましたが、テーマコンパイラ内で
  用いるアイコンIDは、これまでどおり "icon_bdvd_setting"を指定してください。

- RAF形式の背景を適用した状態でインターネットブラウザを起動した場合、
  一時的に標準の背景に戻ります。

----------------------------------------------------------------------
BDエミュレータ
----------------------------------------------------------------------
- Blu-ray Discドライブのアクセスパターンによっては、読み出し時間が実ドライブと
  異なる場合があります。

----------------------------------------------------------------------
libperf
----------------------------------------------------------------------
- SDK180より前のlibperf.aをリンクしたプログラムで、Lv-2の
  システムコールトレースをバックトレースつきで有効化した場合、
  SDK180以降にシステムアップデートされたターゲットシステム上では
  動作しません。(libperf\ppuサンプルが該当)
  SDK180以降にリリースされているlibperf.aを使用してください。

- (B#43808)
  ターゲット上の計測モジュールを使用するため、libperfのサンプルプログラム
  をTuner for PlayStation(R)3で計測することはできません。

- DECR-1400にはトレース専用外部メモリが実装されていません。このため、
  トレースバッファに外部メモリを指定することはできません。
  指定した場合、cellPerfAddCBEpm() の呼び出しで EPERM (0x80010009)
  エラーとなります。

  このため、サンプル samples\sdk\libperf\ppu は動作しません。

- (B#73661)
  Lv-2のシステムコールトレースをバックトレース付きで有効化した場合、
  スタックがVM領域、あるいはページフォルトノティフィケーション領域
  に配置されると対象プログラムで例外が発生します。
  スタックを常に読める領域に配置するか、バックトレースサイズを0に
  して、バックトレース機能を無効にしてください。

----------------------------------------------------------------------
Contorol Console
----------------------------------------------------------------------
- SDK310で提供された新機能は、過去のバージョンのSDKで提供された
  Control Console では問題が発生するため、 "_COMPATIBILITY 0x31000000"
  コンソールコマンドが実行された場合にのみ有効となります。

