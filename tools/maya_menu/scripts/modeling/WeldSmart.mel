global proc WeldSmart(){$his = `constructionHistory -q -tgl`;$timeOut = timerquery();global float $gMergeValue;global float $gMergeValuerRes;global float $gMergeValueLarge;$gMergeValue = 0.1;$gMergeValueLarge = 10000;////////////////////////////////////////////////////////////////////////////////// o && camera////////////////////////////////////////////////////////////////////////////////if (whatIsSel() == "o" && (!uvEditorSelected()))	{	$sel = `ls -sl`;	$verts = `size (conv($sel, "v"))`;	float $time = timeSimple ("end");	if ($time < 1)		$gMergeValuerRes *= 5;	else		$gMergeValuerRes = 0.1;	string $obj;	for ($obj in $sel)		polyMergeVertex -d $gMergeValuerRes -ch $his $obj;	timeSimple start;	select $sel;	$verts2 = `size (conv($sel, "v"))`;	$size = $verts - $verts2;	if ($size == 0)		warning ($gMergeValuerRes + ". NO VERTTICES WELDED WITH THIS THRESHOLD");	else		print ("MergeValue - " + $gMergeValuerRes + ". " + $size + " verts welded");	}////////////////////////////////////////////////////////////////////////////////// o && uvEditorSelected////////////////////////////////////////////////////////////////////////////////else if (whatIsSel() == "o" && uvEditorSelected())	{	$sel = sel();	$verts = `size (conv($sel, "u"))`;	polyMergeUV -d $gMergeValue -ch 1;	$verts2 = `size (conv($sel, "u"))`;	$size = $verts - $verts2;	print ("MergeValue - " + $gMergeValue + ". " + $size + " uvs verts welded");	select $sel;	}////////////////////////////////////////////////////////////////////////////////// v > 1 || "e" || "f"////////////////////////////////////////////////////////////////////////////////else if ((whatIsSel() == "v" && sizeSel() > 1) || whatIsSel() == "e" || whatIsSel() == "f")	{	if ($timeOut <= 0.2)		{		$sel = `ls -sl`;		$verts = `size (conv($sel, "v"))`;		polyMergeVertex -d $gMergeValue -ch $his;		$verts2 = `size (conv($sel, "v"))`;		$size = $verts - $verts2;		print ("MergeValue - " + $gMergeValue + ". " + $size + " verts welded");		}	else		{		if (whatIsSel() == "e" || whatIsSel() == "f")			performPolyCollapse 0;		else			{			int $sizeVwas = sizeSel();			polyMergeVertex -d $gMergeValueLarge -ch $his;			int $sizeVnow = sizeSel();			if ($sizeVwas == $sizeVnow)			warning ("no verts welded. " + $sizeVnow + " selected.");		else			print ("was " + $sizeVwas + ", now it is " + $sizeVnow + " verts.");			}		}	}////////////////////////////////////////////////////////////////////////////////// v = 1////////////////////////////////////////////////////////////////////////////////else if (whatIsSel() == "v" && sizeSel() == 1)	{	string $vertTarget = stringSingle(`ls -sl -fl`);	float $vertTargetPos[] = `pointPosition $vertTarget`;	string $uvsTarget[] = conv({$vertTarget}, "u");	string $object = selObj();	goToLastSelection;	string $vert = stringSingle(`ls -sl -fl`);	string $uvs[] = conv({$vert}, "u");	string $uv;	for ($uv in $uvs)		{	//$uv = $uvs[0];	//select $uv;	//select $uvTarget;		string $uvTarget = stringSingle (stringIntersect ((conv(conv({$uv}, "f"), "u")), $uvsTarget));		if (`size $uvTarget` == 0)			$uvTarget = $uvsTarget[0];		float $uvPos[];		if ($uvTarget != "")			{			$uvPos = pointPositionUV($uvTarget);			polyEditUV -r 0 -u $uvPos[0] -v $uvPos[1] $uv;			}		}	move $vertTargetPos[0] $vertTargetPos[1] $vertTargetPos[2] $vert;	select $vert $vertTarget;	polyMergeVertex -d $gMergeValueLarge;//	selectPointsInDistance($vertDestPos, 0, $object);	selectionMode($object, "v");	hideUvEditor "";	}////////////////////////////////////////////////////////////////////////////////// u = 1////////////////////////////////////////////////////////////////////////////////else if (whatIsSel() == "u")	{	$sel = `ls -sl`;	$verts = `size (conv($sel, "u"))`;	polyMergeUV -d $gMergeValue -ch $his;	$verts2 = `size (conv($sel, "u"))`;	$size = $verts - $verts2;	print ("MergeValue - " + $gMergeValue + ". " + $size + " uvs verts welded");	}else	print "control + w not work with this SITUATION";}